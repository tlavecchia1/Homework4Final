'use strict';var Sh=function(a){return"urn:x-cast:com.google.cast."+a},Th=Sh("tp.connection"),Uh=Sh("receiver"),Vh=Sh("media"),Wh=Sh("webrtc"),Xh=Cb({Pba:Th,Qba:Sh("tp.heartbeat"),iba:Uh,DL:Vh,laa:Sh("media.universalRemote.optIn"),gca:Wh});var Yh={faa:0,X$:1},Zh={bca:0,ZL:1,jba:2},$h={DIAL:0,jaa:1,kaa:2,c$:3},ai={Faa:0,TIMEOUT:1,k$:2},bi={Dz:0,u9:1,U9:2,w$:3,O9:4,raa:5},ci=function(a){Mg("MediaRouter.Cast.Session.Ended",a,Zh)},di=function(a){Mg("MediaRouter.Cast.Discovery.Type",a,$h)},ei=function(a){Mg("MediaRouter.Cast.Session.Fail",a,ai)};var fi=function(a){return"available"==a||"available_rescan"==a};var gi=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=e||null;this.domain=f||null;this.isLaunching_=!1};var hi=function(a,b){this.Fd=this.Do=this.zf=this.Gb=this.Dc=null;this.Yc=new gi(wf.O().Wo(b),a);this.ld={};this.Sn={};this.Ny=this.Qr=this.Rv=!1};d=hi.prototype;d.Jf=function(){return this.Yc};d.Bu=function(){return this.Yc.friendlyName};d.If=function(){return this.Fd};d.g5=function(a){this.Fd=a;return this};d.getId=function(){return this.Yc.id};d.qr=function(a){this.Yc.id=a;return this};d.rr=function(a){this.Rv=a;return this};d.I7=function(){return this.Qr};d.sy=function(a){this.Qr=a;return this};
d.w6=function(a){this.Ny=a;return this};d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.Yc.friendlyName!=a.Yc.friendlyName&&(this.Yc.friendlyName=a.Yc.friendlyName,b=!0);this.zf!=a.zf&&(this.zf=a.zf,b=!0);return b};d.Vb=function(){return this.Dc};d.M4=function(a){this.Dc=a;return this};d.Wb=function(){return this.Gb};d.xk=function(a){this.Gb=a;return this};d.fS=function(){return this.zf};d.l4=function(a){this.zf=a;return this};d.NC=function(){return this.Do};
d.k4=function(a){this.Do=a;return this};d.Rd=function(a){return this.ld[a]||"unknown"};d.VQ=function(a){return this.Sn[a]||null};d.mr=function(a,b){this.ld[a]=b;this.Sn[a]=t();return this};d.hK=function(){return"name = "+this.Yc.friendlyName+(this.Dc?", ip = "+this.Dc:"")+(this.Fd?", model = "+this.Fd:"")+", apps = "+JSON.stringify(this.ld)};
var ii=function(a){var b=new hi(a.Yc.friendlyName,"");b.Yc.id=a.Yc.id;b.Dc=a.Dc;b.Gb=a.Gb;b.zf=a.zf;b.Do=a.Do;b.Fd=a.Fd;b.ld=a.ld;b.Sn=a.Sn;b.Rv=a.Rv;b.Qr=a.Qr;b.Ny=a.Ny;return b};var ki=function(a,b,c,e,f,g){this.Jc=new gi(ji(a),b,this.QD(e));this.Fd=c||null;this.Fg=e||null;this.Dc=f||null;this.Gb=g||null;this.ld={};this.Fo=!1},ji=function(a){return wf.O().Wo(a)},li=function(a){if(!a.If())return null;var b=a.If();if(!a.Vb())return null;var c=a.Vb(),e=a.Jf().id,f;f=a.Jf().friendlyName;f=-1!=f.indexOf("&")?"document"in h?Da(f):Ea(f):f;b=new ki(e,f,b,void 0,c,wf.O().bl||8009);b.Jc.id=a.Jf().id;b.KI(!0);return b};d=ki.prototype;
d.update=function(a,b,c,e){var f=!1;this.Jc.friendlyName!=a&&(this.Jc.friendlyName=a,f=!0);this.Dc!=b&&(this.Dc=b,f=!0);this.Gb!=c&&(this.Gb=c,f=!0);this.Fg!=e&&(this.Fg=e,f=!0);return f};d.Jf=function(){return this.Jc};d.Bu=function(){return this.Jc.friendlyName};d.If=function(){return this.Fd};d.yl=function(){return this.Fg};d.QD=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.O3=function(a){this.Fg=a;this.Jc.iconType=this.QD(this.Fg)};d.getId=function(){return this.Jc.id};
var mi=function(a){var b=new ki("",a.Jc.friendlyName,a.Fd,a.Fg,a.Dc,a.Gb);b.Jc.id=a.Jc.id;b.ld=a.ld;b.Fo=a.Fo;return b};d=ki.prototype;d.Vb=function(){return this.Dc};d.Wb=function(){return this.Gb};d.Rd=function(a){return this.ld[a]||"unknown"};d.mr=function(a,b){this.ld[a]=b};d.hK=function(){return"name = "+this.Jc.friendlyName+(this.Dc?", ip = "+this.Dc:"")+(this.Fd?", model = "+this.Fd:"")+", capabilities = "+this.Fg+", apps = "+JSON.stringify(this.ld)};d.KI=function(a){this.Fo=a};d.Zp=function(){return this.Fo};var ni=function(a,b){this.fe=b;this.hO=a;this.Qg=r(this.zH,this);this.Ic=new z;this.Ck=new z;this.Ph=new z;this.ww=null;this.em=this.$f="";this.Wi=null;this.Zl=!1};ni.prototype.a=A("mr.cast.SinkDiscoveryService");var oi={serviceType:"_googlecast._tcp.local"};d=ni.prototype;d.init=function(){Ve(this);this.Zl&&(this.yF(),this.fC())};d.yF=function(){F(this.a,"Start listening to network changes");chrome.networkingPrivate.onNetworksChanged.addListener(this.fC.bind(this))};
d.start=function(){var a=t();if(chrome.mdns.onServiceList.hasListener(this.Qg)){if(6E4>a-this.ww)return;F(this.a,"Forcing mdns discovery");this.ww=a;chrome.mdns.forceDiscovery(ca);chrome.mdns.onServiceList.removeListener(this.Qg)}F(this.a,"Adding mdns listener");this.ww=a;chrome.mdns.onServiceList.addListener(this.Qg,oi)};d.stop=function(){F(this.a,"Removing mdns listener");chrome.mdns.onServiceList.removeListener(this.Qg)};
d.hP=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return E(this.a,"Missing ID"),null;var e=ji(c);if(this.Ph.Ja(e))return null;var f=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(f)||0>f||65535<f)return E(this.a,"Missing or invalid port"),null;var g=b.fn;if(!g||!a.ipAddress)return E(this.a,"Missing friendly name or IP address"),
null;var k=Number(b.ca),k=isNaN(k)?0:k;if(e=this.Ic.get(e))return e.update(g,a.ipAddress,f,k)&&(e.KI(!1),this.fe.be(e)),null;e=b.md;return e?new ki(c,g,e,k,a.ipAddress,f):(E(this.a,"Missing model name"),null)};d.refresh=function(){G(this.a,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(ca)};d.zH=function(a){F(this.a,"Registering "+a.length+" devices");this.iP(a).forEach(this.AY,this)};
d.BA=function(a,b){this.Ph.Ja(a.getId())||(this.Ph.set(a.getId(),a),this.cl(a).then(function(c){c?(c=this.Ic.get(a.getId()),b&&(c?c.Zp()&&di(3):di(1)),this.Gs(a)):F(this.a,"Inaccessible sink: "+a.getId())},null,this).Va(function(){this.Ph.remove(a.getId());0==this.Ph.M()&&this.Qq()},this))};d.AY=function(a){this.BA(a,!0)};d.iP=function(a){var b=[];a.forEach(function(a){(a=this.hP(a))&&b.push(a)},this);return b};
d.Gs=function(a){F(this.a,"Adding sink "+a.getId());var b=this.Ic.get(a.getId()),c=null,e=a.Vb(),f=a.Wb();null!=e&&null!=f&&(c=this.Ck.get(e+":"+f));if(b&&!c){var g=a.Vb(),k=a.Wb();g&&k&&this.Ck.remove(g+":"+k)}c&&!b&&this.Ic.remove(c.getId());this.Ic.set(a.getId(),a);null!=e&&null!=f&&this.Ck.set(e+":"+f,a);this.Zl||(this.Zl=!0,this.yF());this.fe.Ne(a);wf.O().Vh=new vf(a.If(),a.Vb())};d.Gw=function(a){F(this.a,"Channel error for sink "+a);this.Yq(a)};
d.Yq=function(a){var b=this.Ic.get(a);if(b){F(this.a,"Removing sink "+a);this.Ic.remove(a);a=b.Vb();var c=b.Wb();null!=a&&null!=c&&this.Ck.remove(a+":"+c);this.fe.Eq(b)}};d.V1=function(){var a=this.Ic.v();this.Ic.clear();this.Ck.clear();a.forEach(this.fe.Eq,this.fe)};d.cl=function(a){G(this.a,"Checking access to "+a.getId());return this.hO.Qi(a).then(function(b){if(a.Zp()){var c=4;b.audioOnly||(c|=1);a.O3(c)}return!0},function(){return!1})};
d.Qq=function(){F(this.a,"Pruning inactive sinks.");mc(this.Fp(),function(a){this.Ph.set(a.getId(),a);this.cl(a).then(function(b){b||this.Yq(a.getId())},null,this).Va(function(){this.Ph.remove(a.getId())},this)},this)};d.ga=function(a){return this.Ic.get(a,null)};d.rV=function(a,b){return this.Ck.get(a+":"+b)};d.SD=function(a){var b=[];mc(this.Fp(),function(c){fi(c.Rd(a))&&b.push(c)});return b};d.Fp=function(){return this.Ic.sv()};d.CK=function(a){this.fe.be(a)};d.oc=function(){return this.Ic.v()};
var pi=function(a,b){this.sinkMap=a;this.networkIds=b;this.version=1},qi=function(a){this.hasSavedSinks=a};d=ni.prototype;d.Oa=function(){return"cast.SinkDiscoveryService"};d.getData=function(){return[new pi(this.Ic.b(),this.em),new qi(this.Zl)]};d.rb=function(){var a=Se(this);a&&1==a.version&&(this.em=a.networkIds,this.BF(a.sinkMap));if(a=Te(this))this.Zl=a.hasSavedSinks};d.BF=function(a){for(var b in a){var c=mi(a[b]);this.ga(c.getId())||this.BA(c,!1)}};
d.fC=function(){F(this.a,"Fetching networks state");this.Wi&&cf(this.Wi);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(a){for(var b=[],c=0;c<a.length;c++)"Connected"==a[c].ConnectionState&&b.push(a[c].GUID);this.l8(b.sort().join(","))}.bind(this))};
d.l8=function(a){F(this.a,"Update current network "+ri(a));a!=this.$f&&(this.Wi&&(Ue.remove(this.Wi.Oa()),this.Wi=null),a?(this.em&&a!=this.em?this.V1():this.Qq(),this.em=this.$f=a,this.Wi=new si(this,this.$f)):this.$f="")};var ri=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},si=function(a,b){this.ed=a;this.$f=b;Ve(this)};si.prototype.Oa=function(){return"cast.NetworkSink."+this.$f};
si.prototype.getData=function(){var a=null,b=this.ed.getData();b&&0<this.ed.oc().length&&(a=b[0]);F(this.ed.a,"Saving sink data for network "+ri(this.$f));return[null,a]};si.prototype.rb=function(){F(this.ed.a,"Restoring sink data for network "+ri(this.$f));var a=Te(this);a&&1==a.version&&this.ed.BF(a.sinkMap)};var ti={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var ui=function(){this.type="GET_STATUS";this.requestId=0};var vi=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var wi=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var xi=function(a,b){this.requestId=a;this.W7=b;this.gK=null};xi.prototype.Iw=function(){};var yi=function(){this.tb=new z};yi.prototype.Rz=function(a){this.tb.set(a.requestId,a);a.gK=setTimeout(this.H_.bind(this,a),a.W7)};yi.prototype.Im=function(a){var b=this.tb.get(a);if(!b)return null;clearTimeout(b.gK);this.tb.remove(a);return b};yi.prototype.ih=function(a){return this.tb.get(a,null)};yi.prototype.H_=function(a){this.tb.remove(a.requestId);a.Iw()};var zi=function(a){this.B7=a;this.Wj=1E3*Math.floor(1E6*Math.random())};d=zi.prototype;d.vB=function(){Ve(this)};d.vp=function(){var a=this.Wj++;0==a&&(a=this.Wj++);return a};d.Oa=function(){return"IdGenerator."+this.B7};d.getData=function(){return[this.Wj]};d.rb=function(){var a=Se(this);a&&(this.Wj=a)};var Ai=function(a,b){this.kc=a;this.Hc=b;this.Qh=new yi;this.MH=new zi("cast.RequestIdGenerator")};Ai.prototype.init=function(){this.MH.vB()};var Bi=function(a,b,c,e){xi.call(this,a,c);this.kb=b;this.sourceId=e};u(Bi,xi);Bi.prototype.Iw=function(){this.kb.reject(Ci)};Ai.prototype.Sz=function(a,b,c){var e=this.MH.vp();a.requestId=e;a=J();b=new Bi(e,a,q(b)&&0<b?b:6E5,c);this.Qh.Rz(b);return b};Ai.prototype.Ex=function(a){this.Qh.Im(a.requestId)};Ai.prototype.Im=function(a){return this.Qh.Im(a)};
var Ci=Error("Timeout"),Di=Error("Failed to send message");Ai.prototype.sendRequest=function(a,b,c,e,f,g){if(!Xh.hasOwnProperty(c))return I(Error("Custom namespace is not supported"));var k=this.Sz(a,m(e)?e:3E3,f),l=k.kb;this.kc.hr(b,c,a,f||this.Hc,g).then(null,function(){this.Ex(k);l.reject(Di)},this);return l.promise};
Ai.prototype.sendMessage=function(a,b,c,e,f,g){var k=this.Sz(a,m(e)?e:3E3,f),l=k.kb;this.kc.hr(b,c,a,f||this.Hc,g).then(function(){this.Ex(k);l.resolve(!0)},function(){this.Ex(k);l.reject(Di)},this);return l.promise};Ai.prototype.u2=function(a,b){var c=new vi(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,Uh,a.requestSessionTimeout)};
Ai.prototype.x2=function(a,b){return this.sendRequest(new wi(a),b,Uh)};var Ei=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b};n("castApp.eventPage.Message",Ei,void 0);var Fi=function(a,b){this.ipAddress=a;this.appId=b};Ei.DeviceData=Fi;var Gi=function(a,b){this.hc=a;this.Oc=b;this.Zi=new z;this.Rg=new yc;this.kF=0;this.KY=new z("serviceCheck",this.IW.bind(this),"startDeviceMonitor",this.QW.bind(this),"releaseDeviceMonitor",this.DW.bind(this));chrome.runtime.onMessage.addListener(this.xW.bind(this));this.de("serviceReady")};d=Gi.prototype;d.a=A("castApp.eventPage.Service");d.FL=3E4;
d.OW=function(){if(this.CA()){var a=new yc;mc(this.hc.Fp(),function(b){var e=b.Vb();a.add(e);this.Zi.Ja(e)||this.Oc.sendRequest(new ui,b,Uh)}.bind(this));var b=!1;this.Zi.Xa().forEach(function(c){a.contains(c)||(this.Zi.remove(c),b=!0)}.bind(this));b&&this.$s()}};
d.mW=function(a,b){if(this.CA()&&Xh.hasOwnProperty(b.namespace_)){var c=a.Vb();if(c){var e=JSON.parse(b.data);if("RECEIVER_STATUS"===e.type){var e=e.status&&e.status.applications&&e.status.applications[0]&&e.status.applications[0].appId||void 0,f=this.Zi.get(c);this.Zi.set(c,new Fi(c,e));f&&f.appId===e||this.$s()}}}};
d.CA=function(){if(0===this.Rg.M())return!1;var a=t();if(a-this.kF>this.FL){this.kF=a;var b=[];chrome.extension.getViews().forEach(function(a){(a=a["castApp.eventPage.Message.OriginID"])&&b.push(a)}.bind(this));this.Rg=this.Rg.LE(b);F(this.a,"monitor client count: "+this.Rg.M())}return 0<this.Rg.M()};
d.xW=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.KY.get(a.subtype);if(!e)return!1;if(!a.originId)return Na("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){B(this.a,"Error while handling request",g)}return!1};d.de=function(a,b){var c=new Ei(a,b);F(this.a,"Sending message: "+JSON.stringify(c));chrome.runtime.sendMessage(c)};d.IW=function(){this.de("serviceReady")};
d.QW=function(a){F(this.a,"Registering monitor client: "+a.originId);this.Rg.add(a.originId);this.$s();this.L1()};d.DW=function(a){F(this.a,"Unregistering monitor client: "+a.originId);this.Rg.remove(a.originId)};d.$s=function(){var a=this.Zi.v();this.de("devices",a)};d.L1=function(){this.hc.refresh();this.hc.oc().forEach(function(a){this.Oc.sendRequest(new ui,a,Uh)}.bind(this))};chrome.cast.ke={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};n("chrome.cast.AutoJoinPolicy",chrome.cast.ke,void 0);chrome.cast.Dn={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};n("chrome.cast.DefaultActionPolicy",chrome.cast.Dn,void 0);chrome.cast.gf={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
n("chrome.cast.Capability",chrome.cast.gf,void 0);chrome.cast.le={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};n("chrome.cast.ErrorCode",chrome.cast.le,void 0);chrome.cast.$L={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
n("chrome.cast.ReceiverAvailability",chrome.cast.$L,void 0);chrome.cast.jM={CHROME:"chrome",IOS:"ios",ANDROID:"android"};n("chrome.cast.SenderPlatform",chrome.cast.jM,void 0);chrome.cast.Fn={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};n("chrome.cast.ReceiverType",chrome.cast.Fn,void 0);chrome.cast.pL={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};n("chrome.cast.DialAppState",chrome.cast.pL,void 0);chrome.cast.Tk={CAST:"cast",STOP:"stop"};
n("chrome.cast.ReceiverAction",chrome.cast.Tk,void 0);chrome.cast.zz={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};n("chrome.cast.SessionStatus",chrome.cast.zz,void 0);chrome.cast.VERSION=[1,2];n("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.J8=!0;n("chrome.cast.usingPresentationApi",chrome.cast.J8,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};n("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.iM=function(a){this.platform=a;this.packageId=this.url=null};n("chrome.cast.SenderApplication",chrome.cast.iM,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
n("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=m(a)?a:null;this.muted=m(b)?b:null};n("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.hL=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.ke.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.Dn.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};n("chrome.cast.ApiConfig",chrome.cast.hL,void 0);chrome.cast.rL=function(a,b){this.appName=a;this.launchParameter=b||null};n("chrome.cast.DialRequest",chrome.cast.rL,void 0);
chrome.cast.qz=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};n("chrome.cast.DialLaunchData",chrome.cast.qz,void 0);chrome.cast.qL=function(a,b){this.doLaunch=a;this.launchParameter=b||null};n("chrome.cast.DialLaunchResponse",chrome.cast.qL,void 0);chrome.cast.yz=function(a,b,c){this.appId=a;this.capabilities=ga(b)?b:[chrome.cast.gf.VIDEO_OUT,chrome.cast.gf.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
n("chrome.cast.SessionRequest",chrome.cast.yz,void 0);chrome.cast.ws=function(a,b,c,e){this.label=a;this.friendlyName=b;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.Fn.CAST;this.displayStatus=this.isActiveInput=null};n("chrome.cast.Receiver",chrome.cast.ws,void 0);chrome.cast.aM=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};n("chrome.cast.ReceiverDisplayStatus",chrome.cast.aM,void 0);
chrome.cast.Cz=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};n("chrome.cast.Timeout",chrome.cast.Cz,void 0);chrome.cast.timeout=new chrome.cast.Cz;n("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.gL="auto-join";chrome.cast.vz="cast-session_";chrome.cast.media.Sk={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};n("chrome.cast.media.MediaCommand",chrome.cast.media.Sk,void 0);chrome.cast.media.jd={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};n("chrome.cast.media.MetadataType",chrome.cast.media.jd,void 0);chrome.cast.media.En={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};n("chrome.cast.media.PlayerState",chrome.cast.media.En,void 0);
chrome.cast.media.xs={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};n("chrome.cast.media.RepeatMode",chrome.cast.media.xs,void 0);chrome.cast.media.bM={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};n("chrome.cast.media.ResumeState",chrome.cast.media.bM,void 0);chrome.cast.media.Az={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};n("chrome.cast.media.StreamType",chrome.cast.media.Az,void 0);
chrome.cast.media.xL={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};n("chrome.cast.media.IdleReason",chrome.cast.media.xL,void 0);chrome.cast.media.tM={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};n("chrome.cast.media.TrackType",chrome.cast.media.tM,void 0);chrome.cast.media.qM={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};n("chrome.cast.media.TextTrackType",chrome.cast.media.qM,void 0);
chrome.cast.media.mM={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};n("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.mM,void 0);chrome.cast.media.rM={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};n("chrome.cast.media.TextTrackWindowType",chrome.cast.media.rM,void 0);
chrome.cast.media.nM={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};n("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.nM,void 0);chrome.cast.media.oM={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};n("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.oM,void 0);chrome.cast.media.vL=function(){this.customData=null};n("chrome.cast.media.GetStatusRequest",chrome.cast.media.vL,void 0);chrome.cast.media.NL=function(){this.customData=null};n("chrome.cast.media.PauseRequest",chrome.cast.media.NL,void 0);chrome.cast.media.PL=function(){this.customData=null};n("chrome.cast.media.PlayRequest",chrome.cast.media.PL,void 0);chrome.cast.media.hM=function(){this.customData=this.resumeState=this.currentTime=null};n("chrome.cast.media.SeekRequest",chrome.cast.media.hM,void 0);
chrome.cast.media.kM=function(){this.customData=null};n("chrome.cast.media.StopRequest",chrome.cast.media.kM,void 0);chrome.cast.media.wM=function(a){this.volume=a;this.customData=null};n("chrome.cast.media.VolumeRequest",chrome.cast.media.wM,void 0);chrome.cast.media.AL=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};n("chrome.cast.media.LoadRequest",chrome.cast.media.AL,void 0);
chrome.cast.media.tL=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};n("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.tL,void 0);chrome.cast.media.uL=function(){this.metadataType=this.type=chrome.cast.media.jd.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};n("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.uL,void 0);
chrome.cast.media.HL=function(){this.metadataType=this.type=chrome.cast.media.jd.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};n("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.HL,void 0);chrome.cast.media.uM=function(){this.metadataType=this.type=chrome.cast.media.jd.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
n("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.uM,void 0);chrome.cast.media.IL=function(){this.metadataType=this.type=chrome.cast.media.jd.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};n("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.IL,void 0);
chrome.cast.media.OL=function(){this.metadataType=this.type=chrome.cast.media.jd.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};n("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.OL,void 0);chrome.cast.media.GL=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.Az.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
n("chrome.cast.media.MediaInfo",chrome.cast.media.GL,void 0);chrome.cast.media.RL=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};n("chrome.cast.media.QueueItem",chrome.cast.media.RL,void 0);chrome.cast.media.nL="CC1AD845";n("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.nL,void 0);chrome.cast.media.timeout={};
n("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.Ya=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.Ya;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.yk=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.yk;chrome.cast.media.timeout.Ot=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.Ot;chrome.cast.media.timeout.p1=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.p1;
chrome.cast.media.sM=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};n("chrome.cast.media.Track",chrome.cast.media.sM,void 0);chrome.cast.media.pM=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
n("chrome.cast.media.TextTrackStyle",chrome.cast.media.pM,void 0);chrome.cast.media.TL=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.xs.OFF;this.customData=null};n("chrome.cast.media.QueueLoadRequest",chrome.cast.media.TL,void 0);chrome.cast.media.QL=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
n("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.QL,void 0);chrome.cast.media.XL=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};n("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.XL,void 0);chrome.cast.media.SL=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};n("chrome.cast.media.QueueJumpRequest",chrome.cast.media.SL,void 0);
chrome.cast.media.WL=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};n("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.WL,void 0);chrome.cast.media.UL=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};n("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.UL,void 0);
chrome.cast.media.VL=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};n("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.VL,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.En.IDLE;this.currentTime=0;this.gF=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.xs.OFF};n("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.Ya=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.Ya;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;
chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.yk=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.yk;chrome.cast.media.u.prototype.Ot=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.Ot;chrome.cast.media.u.prototype.s1=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.s1;
chrome.cast.media.u.prototype.q1=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.q1;chrome.cast.media.u.prototype.C1=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.C1;chrome.cast.media.u.prototype.x1=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.x1;chrome.cast.media.u.prototype.w1=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.w1;
chrome.cast.media.u.prototype.t1=function(a){this.Fu(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.t1;chrome.cast.media.u.prototype.B1=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.B1;chrome.cast.media.u.prototype.z1=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.z1;chrome.cast.media.u.prototype.y1=function(a){this.Fu(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.y1;
chrome.cast.media.u.prototype.A1=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.A1;chrome.cast.media.u.prototype.v1=function(a,b,c,e){a=this.Fu(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.le.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.v1;chrome.cast.media.u.prototype.K7=function(a){return-1<this.supportedMediaCommands.indexOf(a)};
chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.K7;chrome.cast.media.u.prototype.uS=function(){if(this.playerState==chrome.cast.media.En.PLAYING&&0<=this.gF){var a=(t()-this.gF)/1E3,a=this.currentTime+this.playbackRate*a;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.uS;chrome.cast.media.u.prototype.Hs=function(){};
chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.Hs;chrome.cast.media.u.prototype.Gx=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.Gx;chrome.cast.media.u.prototype.Fu=function(a){return Wa(this.items,function(b){return b.itemId==a})};var Hi=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var Ii=function(a){this.Oc=a;this.a=A("mr.cast.ReceiverStatusQuerier")};Ii.prototype.p7=function(a){return(new xf(r(this.o1,this,a),3500,5)).by(2).start().na(function(b){F(this.a,"Failed to get receiver status from "+a.getId());throw b;},this)};Ii.prototype.o1=function(a){F(this.a,"Query receiver status: "+a.getId());return this.Oc.sendRequest(new ui,a,Uh)};var Ji=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.T=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.zz.CONNECTED;this.transportId=""};n("chrome.cast.Session",chrome.cast.T,void 0);chrome.cast.T.prototype.U5=function(a,b,c){a=new Ji(new chrome.cast.Volume(a,null),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverVolumeLevel=chrome.cast.T.prototype.U5;
chrome.cast.T.prototype.T5=function(a,b,c){a=new Ji(new chrome.cast.Volume(null,a),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverMuted=chrome.cast.T.prototype.T5;chrome.cast.T.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.T.prototype.leave=chrome.cast.T.prototype.leave;chrome.cast.T.prototype.stop=function(){};chrome.cast.T.prototype.stop=chrome.cast.T.prototype.stop;chrome.cast.T.prototype.sendMessage=function(){};
chrome.cast.T.prototype.sendMessage=chrome.cast.T.prototype.sendMessage;chrome.cast.T.prototype.Hs=function(){};chrome.cast.T.prototype.addUpdateListener=chrome.cast.T.prototype.Hs;chrome.cast.T.prototype.Gx=function(){};chrome.cast.T.prototype.removeUpdateListener=chrome.cast.T.prototype.Gx;chrome.cast.T.prototype.LM=function(){};chrome.cast.T.prototype.addMessageListener=chrome.cast.T.prototype.LM;chrome.cast.T.prototype.KM=function(){};chrome.cast.T.prototype.addMediaListener=chrome.cast.T.prototype.KM;
chrome.cast.T.prototype.g2=function(){};chrome.cast.T.prototype.removeMediaListener=chrome.cast.T.prototype.g2;chrome.cast.T.prototype.h2=function(){};chrome.cast.T.prototype.removeMessageListener=chrome.cast.T.prototype.h2;chrome.cast.T.prototype.jY=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.loadMedia=chrome.cast.T.prototype.jY;chrome.cast.T.prototype.u1=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.queueLoad=chrome.cast.T.prototype.u1;var Li=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0],e=Ki(a),e=new chrome.cast.T(c.sessionId,c.appId,c.displayName,c.appImages,e);e.senderApps=c.senderApps;e.namespaces=c.namespaces||[];e.transportId=c.transportId;e.statusText=c.statusText;e.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(e.receiver.isActiveInput=b.isActiveInput);return e},Mi=function(a){var b=[];if(!a)return b;a&1&&b.push(chrome.cast.gf.VIDEO_OUT);a&2&&b.push(chrome.cast.gf.VIDEO_IN);
a&4&&b.push(chrome.cast.gf.AUDIO_OUT);a&8&&b.push(chrome.cast.gf.AUDIO_IN);a&32&&b.push(chrome.cast.gf.MULTIZONE_GROUP);return b},Ki=function(a){return new chrome.cast.ws(a.getId(),a.Bu(),Mi(a.yl()))},Oi=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f=0;f<c.length;f++)if(!e.some(function(a){return a.name==c[f].name}))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?
!0:!1},Pi=function(a){ga(a)?a.forEach(Pi):ja(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(ja(a[b])||ga(a[b]))&&Pi(a[b])})},Qi=function(a,b){return a.namespaces.some(function(a){return a.name==b})},Ri=["MultizoneLeader","MultizoneFollower"],Si=function(a){return null!==a&&"MultizoneLeader"==a.appId};var Ti=function(a){this.Oc=a;this.a=A("mr.cast.SessionLauncher")};Ti.prototype.pw=function(a,b){Mg("MediaRouter.Cast.Session.Type",0,Yh);return this.Oc.u2(a,b).then(r(this.uW,this,b),function(a){a&&Ci==a?ei(1):ei(0);return I(a)})};Ti.prototype.uW=function(a,b){G(this.a,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw ei(2),Error(b.reason);var c=Li(a,b.status);F(this.a,"Launched session: "+c.sessionId);return c};var Ui=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=m(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var Vi=function(a,b){this.Th=a;this.yb=b;this.Jj=[];this.Qh=new yi},Wi=function(a,b){xi.call(this,a,3E4);this.kb=b};u(Wi,xi);Wi.prototype.Iw=function(){this.kb.resolve(!1)};d=Vi.prototype;d.a=A("mr.cast.ApiMessenger");d.Bp=function(a){return(a=this.yb.Rc(a))?a.routeId:null};d.listen=function(a,b){this.Jj[a]=b};d.qk=function(a,b,c){G(this.a,"Sending to "+b);G(this.a,JSON.stringify(c));c.clientId=b;this.Th.GP(a,c)};
d.We=function(a,b){var c=this.yb.Rc(a);c&&c.Ov?this.qk(c.routeId,a,b):this.connect(a).then(function(c){c?(c=this.Bp(a))?this.qk(c,a,b):E(this.a,"No route for "+a):E(this.a,"No connected client "+a)},null,this)};d.vm=function(a){G(this.a,"App "+a);var b=this.Bp(a);if(b){if(b=this.Qh.Im(b))(a=this.yb.Rc(a))?(a.Ov=!0,b.kb.resolve(!0)):b.kb.resolve(!1)}else E(this.a,"No route for client "+a)};
d.cZ=function(a){G(this.a,"Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.vm(b):this.Bp(b)?(b=this.Jj[a.type])&&b(a):E(this.a,"No route for "+b)};d.connect=function(a){if(this.xX(a))return H(!0);var b=this.Bp(a);if(!b)return E(this.a,"No route for client "+a),H(!1);if(a=this.Qh.ih(b))return a.kb.promise;var c=J();a=new Wi(b,c);this.Qh.Rz(a);return c.promise};d.xX=function(a){a=this.yb.Rc(a);return null!=a&&a.Ov};var Xi=function(a,b){this.cj=this.ie=this.mk="";this.Gb=null;this.ju=this.Oh="";this.Vc=this.IX=!1;var c;a instanceof Xi?(this.Vc=m(b)?b:a.ZS(),this.yr(a.gv()),this.yy(a.Vl()),this.tk(a.Df()),this.xk(a.Wb()),this.og(a.Wd()),this.ur(a.GU().clone()),this.pr(a.kj())):a&&(c=String(a).match(Me))?(this.Vc=!!b,this.yr(c[1]||"",!0),this.yy(c[2]||"",!0),this.tk(c[3]||"",!0),this.xk(c[4]),this.og(c[5]||"",!0),this.ur(c[6]||"",!0),this.pr(c[7]||"",!0)):(this.Vc=!!b,this.Pe=new Yi(null,null,this.Vc))};d=Xi.prototype;
d.toString=function(){var a=[],b=this.gv();b&&a.push(Zi(b,$i,!0),":");var c=this.Df();if(c||"file"==b)a.push("//"),(b=this.Vl())&&a.push(Zi(b,$i,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Wb(),null!=c&&a.push(":",String(c));if(c=this.Wd())this.Bv()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Zi(c,"/"==c.charAt(0)?aj:bj,!0));(c=this.sS())&&a.push("?",c);(c=this.kj())&&a.push("#",Zi(c,cj));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.bX();c?b.yr(a.gv()):c=a.cX();c?b.yy(a.Vl()):c=a.Bv();c?b.tk(a.Df()):c=a.$W();var e=a.Wd();if(c)b.xk(a.Wb());else if(c=a.zE()){if("/"!=e.charAt(0))if(this.Bv()&&!this.zE())e="/"+e;else{var f=b.Wd().lastIndexOf("/");-1!=f&&(e=b.Wd().substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=qa(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var l=f[k++];"."==l?e&&k==f.length&&g.push(""):".."==l?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(l),e=!0)}e=g.join("/")}else e=f}c?b.og(e):c=a.aX();c?b.ur(a.PR()):c=a.XW();c&&b.pr(a.kj());return b};d.clone=function(){return new Xi(this)};d.gv=function(){return this.mk};d.yr=function(a,b){this.Ug();if(this.mk=b?dj(a,!0):a)this.mk=this.mk.replace(/:$/,"");return this};d.bX=function(){return!!this.mk};d.Vl=function(){return this.ie};d.yy=function(a,b){this.Ug();this.ie=b?dj(a):a;return this};d.cX=function(){return!!this.ie};d.Df=function(){return this.cj};
d.tk=function(a,b){this.Ug();this.cj=b?dj(a,!0):a;return this};d.Bv=function(){return!!this.cj};d.Wb=function(){return this.Gb};d.xk=function(a){this.Ug();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.Gb=a}else this.Gb=null;return this};d.$W=function(){return null!=this.Gb};d.Wd=function(){return this.Oh};d.og=function(a,b){this.Ug();this.Oh=b?dj(a,!0):a;return this};d.zE=function(){return!!this.Oh};d.aX=function(){return""!==this.Pe.toString()};
d.ur=function(a,b){this.Ug();a instanceof Yi?(this.Pe=a,this.Pe.ly(this.Vc)):(b||(a=Zi(a,ej)),this.Pe=new Yi(a,null,this.Vc));return this};d.sS=function(){return this.Pe.toString()};d.PR=function(){return this.Pe.X7()};d.GU=function(){return this.Pe};d.kj=function(){return this.ju};d.pr=function(a,b){this.Ug();this.ju=b?dj(a):a;return this};d.XW=function(){return!!this.ju};d.Ug=function(){if(this.IX)throw Error("Tried to modify a read-only Uri");};
d.ly=function(a){this.Vc=a;this.Pe&&this.Pe.ly(a);return this};d.ZS=function(){return this.Vc};
var dj=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Zi=function(a,b,c){return p(a)?(a=encodeURI(a).replace(b,fj),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},fj=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},$i=/[#\/\?@]/g,bj=/[\#\?:]/g,aj=/[\#\?]/g,ej=/[\#\?@]/g,cj=/#/g,Yi=function(a,b,c){this.Fa=this.ab=null;this.Af=a||null;this.Vc=!!c};
Yi.prototype.ye=function(){if(!this.ab&&(this.ab=new z,this.Fa=0,this.Af)){var a=this;Oe(this.Af,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var gj=function(a,b,c){b=tc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new Yi(null,null,c);a=sc(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];ga(g)?c.JJ(f,g):c.add(f,g)}return c};d=Yi.prototype;d.M=function(){this.ye();return this.Fa};
d.add=function(a,b){this.ye();this.Ej();a=this.pj(a);var c=this.ab.get(a);c||this.ab.set(a,c=[]);c.push(b);this.Fa+=1;return this};d.remove=function(a){this.ye();a=this.pj(a);return this.ab.Ja(a)?(this.Ej(),this.Fa-=this.ab.get(a).length,this.ab.remove(a)):!1};d.clear=function(){this.Ej();this.ab=null;this.Fa=0};d.Qa=function(){this.ye();return 0==this.Fa};d.Ja=function(a){this.ye();a=this.pj(a);return this.ab.Ja(a)};d.Si=function(a){var b=this.v();return Za(b,a)};
d.Xa=function(){this.ye();for(var a=this.ab.v(),b=this.ab.Xa(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.v=function(a){this.ye();var b=[];if(p(a))this.Ja(a)&&(b=gb(b,this.ab.get(this.pj(a))));else{a=this.ab.v();for(var c=0;c<a.length;c++)b=gb(b,a[c])}return b};d.set=function(a,b){this.ye();this.Ej();a=this.pj(a);this.Ja(a)&&(this.Fa-=this.ab.get(a).length);this.ab.set(a,[b]);this.Fa+=1;return this};
d.get=function(a,b){var c=a?this.v(a):[];return 0<c.length?String(c[0]):b};d.JJ=function(a,b){this.remove(a);0<b.length&&(this.Ej(),this.ab.set(this.pj(a),x(b)),this.Fa+=b.length)};d.toString=function(){if(this.Af)return this.Af;if(!this.ab)return"";for(var a=[],b=this.ab.Xa(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.v(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.Af=a.join("&")};d.X7=function(){return dj(this.toString())};
d.Ej=function(){this.Af=null};d.clone=function(){var a=new Yi;a.Af=this.Af;this.ab&&(a.ab=this.ab.clone(),a.Fa=this.Fa);return a};d.pj=function(a){a=String(a);this.Vc&&(a=a.toLowerCase());return a};d.ly=function(a){a&&!this.Vc&&(this.ye(),this.Ej(),this.ab.forEach(function(a,c){var e=c.toLowerCase();c!=e&&(this.remove(c),this.JJ(e,a))},this));this.Vc=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)vc(arguments[b],function(a,b){this.add(b,a)},this)};var hj=function(a,b,c,e,f,g,k,l){this.Ms=a;this.Pc=b||null;this.Yn=c||null;this.Bo=e||null;this.kq=m(f)?f:null;this.Ns=g||null;this.lB=k||null;this.ME=l||!1},ij=/(^\w+)(?:\(([\w,\ ]*)\))?$/,jj=function(a,b){var c=a.match(b+"=([^/]*)");return c?c[1]:null},kj=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:Sa(Ta(a,function(a){a=jj(a,"__castAppId__");if(!a)return null;a=a.match(ij);if(!a||0==a.length)return null;var c=[];3==a.length&&a[2]&&(c=a[2].split(","));return{appId:a[1],capabilities:c}}),
function(a){return null!=a})},lj=function(a){return jj(a,"__castClientId__")};d=hj.prototype;d.ap=function(){return Ta(this.Ms,function(a){return a.appId})};d.UQ=function(){return this.Ms};d.lC=function(){return this.Ns};d.Rb=function(){return this.Pc};d.pC=function(){return this.Yn?this.Yn:chrome.cast.ke.TAB_AND_ORIGIN_SCOPED};d.QR=function(){return this.Bo?this.Bo:chrome.cast.Dn.CREATE_SESSION};d.jT=function(){return null==this.kq?chrome.cast.timeout.requestSession:this.kq};d.eD=function(){return this.ME};
d.toString=function(){var a=new Xi;a.yr("https");a.tk("google.com");a.og("/cast");var b=[];v(this.Ms,function(a){var e="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(e=e+"("+a.capabilities.join(","),e+=")");b.push(e)});this.Pc&&b.push("__castClientId__="+this.Pc);this.Yn&&b.push("__castAutoJoinPolicy__="+this.Yn);this.Bo&&b.push("__castDefaultActionPolicy__="+this.Bo);null!=this.kq&&b.push("__castLaunchTimeout__="+this.kq);this.Ns&&b.push("__dialAppName__="+this.Ns);this.lB&&b.push("__dialPostData__="+
this.lB);this.ME&&b.push("__castInvisibleSender__=true");a.pr(b.join("/"));return a.toString()};d.OX=function(a){var b=this.ap(),c=mj(a);return Ua(b,function(a){return Za(c,a)})};
var nj=function(a){var b=(new Xi(a)).kj();a=kj(b);if(!a||0==a.length)return null;var c=lj(b),e=jj(b,"__castAutoJoinPolicy__"),f=jj(b,"__castDefaultActionPolicy__"),g;g=jj(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=jj(b,"__dialAppName__"),l=jj(b,"__dialPostData__"),b=jj(b,"__castInvisibleSender__");return new hj(a,c,e,f,g,k,l,null===b?null:"true"==b)},mj=function(a){return(a=nj(a))?a.ap():null},oj=function(a){return(a=nj(a))?a.Rb():null};var pj=function(a,b,c,e,f,g){this.Se=a;this.Z=b;this.yb=c;this.ha=e;this.kc=f;this.Th=g;this.wc=new Vi(g,c);this.G1=new Ii(this.Se);this.y3=new Ti(this.Se)};pj.prototype.a=A("mr.cast.ApiHandler");var qj=["00000000-0000-0000-0000-000000000000","E8C28D3C"];d=pj.prototype;d.init=function(){this.yb.init();this.wc.listen("v2_message",this.L_.bind(this));this.wc.listen("app_message",this.hZ.bind(this));this.wc.listen("leave_session",this.KZ.bind(this))};d.Gd=function(a,b){this.wc.cZ(b)};
d.Sx=function(a,b,c,e){a=this.ha.yC(a);c&&0==a.length&&a.push(c.clientId);a.slice().forEach(function(a){a!=e&&this.lI(a,b)},this)};d.lI=function(a,b){b.clientId=a;this.wc.We(a,b)};d.oI=function(a,b,c){b={receiver:Ki(b),action:c};this.lI(a,new Ui("receiver_action",b))};
d.L_=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ha.jv(c);if(e)if(c=this.ha.RD(c))if(c=this.Z.ga(c))switch(b.type){case "STOP":this.eZ(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":this.bZ(a,c,e);break;case "SET_VOLUME":this.dZ(a,c);break;default:E(this.a,"Unknown request")}else this.pk(a,
chrome.cast.le.INVALID_PARAMETER,"No receiver");else this.pk(a,chrome.cast.le.INVALID_PARAMETER,"No sink ID");else this.pk(a,chrome.cast.le.INVALID_PARAMETER,"Unknown session ID")}else this.pk(a,chrome.cast.le.INVALID_PARAMETER,"No session ID")};d.pk=function(a,b,c){b=new chrome.cast.Error(b,c);this.Rx(a,b)};d.Rx=function(a,b){this.wc.We(a.clientId,new Ui("error",b,a.sequenceNumber))};
d.eZ=function(a,b){var c=a.message;Lg("MediaRouter.Cast.Session.End");var e=c.sessionId,f=this.ha.zd(e);f&&(f.cq=!0);this.Se.sendRequest(c,b,Uh,a.timeoutMillis,a.clientId).Va(function(){this.Fx(e,a)},this)};d.bZ=function(a,b,c){var e=a.message,f=e.type;f in ti&&(e.type=ti[f]);this.Se.sendRequest(e,b,Vh,a.timeoutMillis,a.clientId,c.transportId).then(function(b){this.mH(c,b);this.wc.We(a.clientId,new Ui("v2_message",b,a.sequenceNumber))},function(b){this.Rx(a,b)},this)};
d.dZ=function(a,b){var c=a.message;delete c.sessionId;this.Se.sendRequest(c,b,Uh,a.timeoutMillis,a.clientId).then(function(){this.wc.We(a.clientId,new Ui("v2_message",null,a.sequenceNumber))},function(b){this.Rx(a,b)},this)};
d.hZ=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ha.RD(c);e?(e=this.Z.ga(e))?(c=this.ha.jv(c),Xa(c.namespaces,function(a){return a.name==b.namespaceName})?this.kc.hr(e,b.namespaceName,b.message,a.clientId,c.transportId).then(function(){this.wc.We(a.clientId,new Ui("app_message",null,a.sequenceNumber))},function(){this.pk(a,chrome.cast.le.CHANNEL_ERROR,"Channel to receiver not available")},this):this.pk(a,chrome.cast.le.INVALID_PARAMETER,"Invalid namespace")):E(this.a,"No receiver from sinkId"):
E(this.a,"No sinkId from sessionId")}else E(this.a,"No sessionId")};d.j2=function(a){a.dd.slice().forEach(function(a){this.Th.fV(a)||this.Th.Jm(a,!0)}.bind(this))};d.Eq=function(a){(a=this.ha.Ml(a))&&a.session&&this.Fx(a.session.sessionId)};
d.KZ=function(a){F(this.a,"Leave session");var b=a.message,c=this.ha.zd(b);if(c){var e=a.clientId,f=this.yb.Rc(e);if(f){var g=[],k=[],l=f.tabId,w=f.origin,C=f.autoJoinPolicy;c.se.forEach(function(a){var b=this.yb.Rc(a);C==chrome.cast.ke.TAB_AND_ORIGIN_SCOPED&&l==b.tabId&&w==b.origin||C==chrome.cast.ke.ORIGIN_SCOPED&&w==b.origin?g.push(a):k.push(a)},this);this.wc.We(e,new Ui("leave_session",null,a.sequenceNumber));g.forEach(function(a){this.wc.We(a,new Ui("disconnect_session",b))},this);c.se=k}else E(this.a,
"No client record")}else E(this.a,"No session")};d.rH=function(a,b){Qi(a,Vh)&&this.Se.sendRequest(new ui,b,Vh,void 0,void 0,a.transportId).na(ca)};d.sH=function(a,b){var c=a.getId();F(this.a,"Query status for "+c);this.G1.p7(a).then(function(e){this.GG(c,e);b&&(e=this.ha.Dp(c))&&this.rH(e,a)},ca,this)};d.q_=function(a,b){Xh.hasOwnProperty(b.namespace_)?this.n_(a,b):this.m_(a,b)};
d.UX=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.kc.LD()||null!=this.yb.Rc(a))return!0;F(this.a,"Invalid destination "+a);return!1};
d.n_=function(a,b){G(this.a,"Cast message: "+JSON.stringify(b));if(this.UX(b))if(b.namespace_==Wh){var c=this.ha.Ml(a);c&&c.dd.forEach(function(a){this.Th.FP(a,b)}.bind(this))}else{var c=JSON.parse(b.data),e=this.AW(c),e=e?e.sourceId:void 0;switch(c.type){case "RECEIVER_STATUS":this.GG(a,c);break;case "MEDIA_STATUS":this.p_(a,b,e)}}else this.kc.NA(a,b.destinationId,b.sourceId,!0)};
d.AW=function(a){var b=this.Se.Im(a.requestId);if(!b)return null;var c=b.kb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId,c.reject(new chrome.cast.Error(chrome.cast.le.SESSION_ERROR,a.reason||a.type,a));default:c.resolve(a)}return b};
d.m_=function(a,b){G(this.a,"App message: "+JSON.stringify(b));var c=this.ha.Dp(a);if(c){var e=[],e="*"==b.destinationId?this.ha.yC(c.sessionId):[b.destinationId],f=new Hi(c.sessionId,b.namespace_,b.data);e.forEach(function(a){this.wc.We(a,new Ui("app_message",f))},this)}else E(this.a,"No session for incoming app message")};
var rj=function(a,b){a.forEach(function(a){a.sessionId=b;var e=a.supportedMediaCommands,f=[];e&1&&f.push(chrome.cast.media.Sk.PAUSE);e&2&&f.push(chrome.cast.media.Sk.SEEK);e&4&&f.push(chrome.cast.media.Sk.STREAM_VOLUME);e&8&&f.push(chrome.cast.media.Sk.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=pj.prototype;d.mH=function(a,b){var c=a.sessionId;b.sessionId=c;this.ha.k6(c,rj(b.status,c))};d.WZ=function(a,b,c){this.wc.We(c,new Ui("new_session",a));this.rH(a,b)};
d.hk=function(a){if(a=this.ha.Dp(a)){a=a.sessionId;var b=this.ha.zd(a);b&&b.cq||this.Fx(a)}};d.Fx=function(a,b){this.Sx(a,new Ui("remove_session",a,b?b.sequenceNumber:void 0),b);var c=this.ha.zd(a);c&&this.j2(c);this.ha.k2(a)};
d.GG=function(a,b){G(this.a,"Receiver status for "+a);var c=b.status;if(c){var e=this.Z.ga(a);if(e)if(c=Li(e,c),!c||!c.sessionId||-1<qj.indexOf(c.appId))this.hk(a,"receiver-app-end"),ci(1);else if(c.namespaces&&0!=c.namespaces.length||Si(c)){var f=this.ha.Ml(a);f?this.NW(f,c):this.Th.ne(null,e,null,c)}else this.hk(a,"receiver-app-end"),ci(1);else Lg("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),E(this.a,"Got message from receiver "+a+", but sink is no longer available.")}};
d.NW=function(a,b){var c=a.session;Oi(c,b)&&(c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.Th.v8(a),this.Sx(c.sessionId,new Ui("update_session",c),void 0))};d.p_=function(a,b,c){if(a=this.ha.Dp(a))if(b=JSON.parse(b.data))this.mH(a,b),this.Sx(b.sessionId,new Ui("v2_message",b),void 0,c)};d.wO=function(a,b){var c=Mi(b.yl()),e=Xa(a.UQ(),function(a){return Va(a.capabilities,function(a){return Za(c,a)})});return e?e.appId:a.ap()[0]};
d.pw=function(a,b){var c=nj(a);if(!c)return I(Error("Invalid source "+a));var e=this.wO(c,b),c=c.jT(),f=new Hg("MediaRouter.Cast.Session.Launch");return this.y3.pw(new chrome.cast.yz(e,void 0,c),b).then(function(a){f.end("Success");return H(a)},function(a){f.end("Failure");return I(a)},this)};var sj=A("mr.RuntimeErrorUtils"),tj=function(){chrome.runtime.lastError&&sj.OB(chrome.runtime.lastError.message||"unknown runtime error")};var uj=function(){this.a=A("mr.cast.ChannelFactory");this.Lq=new z};uj.prototype.Qi=function(a,b){var c=this.Lq.get(a.getId());if(c)return G(this.a,"Using pending creation to "+a.getId()),c;c=this.LP(a,b).then(function(b){this.Lq.remove(a.getId());return b},function(b){this.Lq.remove(a.getId());return I(b)},this);this.Lq.set(a.getId(),c);return c};
uj.prototype.LP=function(a,b){if(1===b)return this.SG(a);var c=q(b)&&1<b?b:3;return(new xf(r(this.SG,this,a),1E3,c)).by(1.5).start().then(null,function(b){F(this.a,"Failed to create channel to "+a.getId()+" after "+c+" attempts.");return I(b)},this)};
uj.prototype.SG=function(a){var b=vj++;F(this.a,"Connecting to (id "+b+") "+a.getId());var c=new Hg("MediaRouter.Cast.Mdns.Channel.Open");return this.N_(a).then(function(a){F(this.a,"Channel opened (id "+b+"): "+JSON.stringify(a));c.end("Success");return a},function(a){F(this.a,"Channel did not open (id "+b+").");c.end("Failure");return I(a)},this)};var vj=0;
uj.prototype.N_=function(a){a={ipAddress:a.Vb(),port:a.Wb(),auth:"ssl_verified",timeout:1E4,livenessTimeout:1E4,pingInterval:5E3,capabilities:0};F(this.a,"Opening channel to "+JSON.stringify(a));var b=J();chrome.cast.channel.open(a,r(function(a){tj();"open"==a.readyState?b.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this)),b.reject(Error(a.errorState)))},this));return b.promise};var wj=function(a,b,c,e){return{namespace_:a,data:p(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var yj=function(a){this.type="CONNECT";this.origin={};this.userAgent=Ob;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:Qh,platform:xj(),systemVersion:b,connectionType:1};this.connType=a?0:2},xj=function(){switch(xh()?"ChromeOS":Kc?"Windows":Jc?"Mac":Lc?"Linux":"Other"){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var zj=function(){this.je=new z};da(zj);d=zj.prototype;d.init=function(){Ve(this)};d.Qw=function(a,b,c,e){this.MA(a,b,c,!1);var f=wj(Th,new yj(e),b,c);chrome.cast.channel.send(a,f,r(this.aC,this));this.je.set(this.Zv(a,b,c),e)};d.MA=function(a,b,c,e){if(this.CE(a,b,c)){var f=0;this.je.forEach(function(a,b){var e=b.split("#")[2];a&&e==c&&f++});if(e||1<f)this.IH(a,b,c),b=wj(Th,{type:"CLOSE"},b,c),chrome.cast.channel.send(a,b,r(this.aC,this))}};d.IH=function(a,b,c){this.je.remove(this.Zv(a,b,c))};
d.m2=function(a){this.je.Xa().forEach(function(b){b.split("#")[0]==a.channelId.toString()&&this.je.remove(b)},this)};d.UY=function(a,b){this.je.forEach(function(c,e){var f=e.split("#");f[0]==a.channelId.toString()&&(this.Qw(b,f[1],f[2],c),this.je.remove(e))},this)};d.dQ=function(a,b,c){this.CE(a,b,c)||this.Qw(a,b,c,0==c.indexOf("receiver-0"))};d.CE=function(a,b,c){return this.je.Ja(this.Zv(a,b,c))};d.aC=function(){tj()};d.Zv=function(a,b,c){return[a.channelId,b,c].join("#")};
var Aj=function(a){this.UK=a};zj.prototype.Oa=function(){return"cast.VirtualConnectionManager"};zj.prototype.getData=function(){var a=this.je.b();return[new Aj(a)]};zj.prototype.rb=function(){var a=Se(this);if(a)for(var b in a.UK)this.je.set(b,a.UK[b])};var Bj=function(a,b){this.nt=b;this.Hc=a;this.a=A("mr.cast.ChannelService");this.hg=new z;this.pf=new z;this.wi=zj.O();this.oO=new uj};d=Bj.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(r(this.oZ,this));chrome.cast.channel.onError.addListener(r(this.mZ,this));this.wi.init();Ve(this)};d.LD=function(){return this.Hc};d.hr=function(a,b,c,e,f){var g=e||this.Hc,k=f||"receiver-0";return this.Qi(a).then(function(a){return this.r3(a,b,c,g,k)},null,this)};
d.O_=function(a,b,c,e){return this.Qi(a).then(function(a){this.wi.Qw(a,b,c,e)},null,this)};d.NA=function(a,b,c,e){(a=this.hg.get(a))&&this.wi.MA(a,b,c,e)};
d.oZ=function(a,b){var c=this.pf.get(a.channelId);if(c){if(Xh.hasOwnProperty(b.namespace_)){var e=JSON.parse(b.data);if("CLOSE"==e.type){this.wi.IH(a,b.destinationId,b.sourceId);return}F(this.a,"Got message "+(e.type||e.responseType)+" from "+c.getId())}else F(this.a,"Got message in "+b.namespace_+" from "+c.getId());this.nt.nZ(c,b)}else E(this.a,"This message is from unknown receiver.")};
d.OA=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this));var b=this.pf.get(a.channelId);b&&(this.pf.remove(a.channelId),this.hg.remove(b.getId()))};d.mZ=function(a,b){E(this.a,"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):""));b&&this.GM(b.errorState,b);this.LA(a)};
d.GM=function(a,b){var c=null;switch(a){case "unknown":c=0;break;case "authentication_error":c=1;break;case "connect_error":c=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)c=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)c=4;-138==b.netReturnValue&&(c=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)c=1}E(this.a,"Channel error code: "+c);Mg("MediaRouter.Cast.Channel.Error",c,bi)};d.LA=function(a){var b=this.pf.get(a.channelId);this.OA(a);b&&this.Qi(b).then(function(c){F(this.a,"Re-connected to receiver: "+b.getId());this.wi.UY(a,c);this.nt.pZ(b)},function(){F(this.a,"Failed to re-connect to receiver: "+b.getId());this.wi.m2(a);this.nt.Gw(b,a.errorState)},this)};
d.Qi=function(a){var b=a.getId(),c=this.hg.get(b);return c&&"open"==c.readyState?H(c):this.oO.Qi(a).then(function(c){if(this.pf.Ja(c.channelId))return c;this.hg.get(b)&&(E(this.a,"Duplicate channel to a receiver "+b),this.OA(this.hg.get(b)));F(this.a,"Connected to: "+a.getId());this.hg.set(b,c);this.pf.set(c.channelId,a);return c},null,this)};
d.r3=function(a,b,c,e,f){this.wi.dQ(a,e,f);Pi(c);var g=wj(b,c,e,f);F(this.a,"Channel is sending message");G(this.a,"....message was: "+JSON.stringify(g));return new Od(function(b,c){chrome.cast.channel.send(a,g,r(function(a){tj();a.errorState?(c(Error("Failed to send message")),this.LA(a)):b(!0)},this))},this)};var Cj=function(a,b){this.F1=a;this.zA=b};Bj.prototype.Oa=function(){return"cast.ChannelService"};Bj.prototype.getData=function(){return[new Cj(this.hg.b(),this.pf.b())]};
Bj.prototype.rb=function(){var a=Se(this);if(a){this.hg.addAll(a.F1);for(var b in a.zA)this.pf.set(b,mi(a.zA[b]))}};var Dj=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var Ej=function(a,b){this.Se=a;this.Z=b;this.tb=new yc;this.Ib=new z};d=Ej.prototype;d.a=A("mr.cast.AppDiscoveryService");d.init=function(){Ve(this)};d.tx=function(a){var b=this.Ib.get(a);b?b.vx++:(this.Ib.set(a,{vx:1}),this.b3())};d.Vy=function(a){var b=this.Ib.get(a);b&&(b.vx--,0<b.vx||(this.Z.SD(a).forEach(function(b){"available"==b.Rd(a)&&b.mr(a,"available_rescan")}),this.Ib.remove(a)))};d.b3=function(){F(this.a,"Scanning sinks for app availability");mc(this.Z.Fp(),this.Rm,this)};
d.Rm=function(a){mc(this.Ib.gT(),function(b){var c=a.Rd(b);if("unknown"==c||"available_rescan"==c){var e=a.getId()+":"+b;this.tb.contains(e)||(this.tb.add(e),this.ot(a,b).then(function(e){e!=c&&(F(this.a,b+" on "+a.getId()+" is "+e),a.mr(b,e),this.Z.CK(a))},null,this).Va(function(){this.tb.remove(e)},this))}},this)};
d.ot=function(a,b){var c=new Dj;c.appId=[b];var e=new Hg("MediaRouter.Cast.App.Availability");return this.Se.sendRequest(c,a,Uh,5E3).then(function(a){e.end("Success");G(this.a,"App availability response "+JSON.stringify(a));for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(){e.end("Failure");return"unknown"},this)};var Fj=function(a){this.S1=a};Ej.prototype.Oa=function(){return"cast.AppDiscoveryService"};
Ej.prototype.getData=function(){return[new Fj(this.Ib.b())]};Ej.prototype.rb=function(){var a=Se(this);a&&this.Ib.addAll(a.S1)};var Gj=function(a,b){this.sinks=a;this.origins=b||null},Hj=new Gj([]);var Ij=function(){},Jj=function(a){if(!qa(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=La(b,"/",2);if(3!=b.length)return null;var c=La(b[1],"-",1);if(2!=c.length)return null;var e=new Ij;e.Pka=a;e.Y0=b[0];e.Yja=c[0];e.kla=c[1];e.rg=b[2];return e};Ij.prototype.yD=function(){return this.Y0};Ij.prototype.aa=function(){return this.rg};var Kj=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.Ui=e},Lj=function(a,b,c,e,f,g,k){return new Kj("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var Mj=function(a,b,c,e){return Lj(c,"cast",b.getId(),a,e,"",null)};var Nj=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.Ov=!1},Oj=function(){this.jb=[]};d=Oj.prototype;d.init=function(){Ve(this)};d.M=function(){return this.jb.length};d.Rc=function(a){return Xa(this.jb,function(b){return b.clientId==a})};d.Of=function(a){return Xa(this.jb,function(b){return b.routeId==a})};d.Cs=function(a,b,c,e,f,g){a=new Nj(a,b,c,e,f,g);this.jb.push(a);return a};
d.Cx=function(a){this.jb=Sa(this.jb,function(b){return b.clientId!=a})};var Pj=function(a){this.Xq=a};Oj.prototype.Oa=function(){return"cast.ClientRecords"};Oj.prototype.getData=function(){return[new Pj(this.jb)]};Oj.prototype.rb=function(){var a=Se(this);a&&(this.jb=a.Xq)};var Qj=function(a){this.Z=a},Rj=function(a){var b=[];a.forEach(function(a){var e="Receiver-"+a.replace(/\./g,"_"),f=wf.O().bl||8009;b.push({serviceName:e+"._googlecast._tcp.local",serviceHostPort:e+":"+f,ipAddress:a,serviceData:["id=mdns:"+e,"ve=02","ca=5","st=1","fn="+e,"md=Chromecast"]})});return b};Qj.prototype.init=function(){var a=Rj(wf.O().eu);this.Z.zH(a)};var Sj=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var Tj=function(a,b){this.se=[];this.dd=[];this.sinkId=a;this.session=b;this.lq=this.lm=null;this.offTheRecord=this.cq=!1};d=Tj.prototype;d.Cs=function(a){if(Za(this.se,a))return!1;this.se.push(a);return!0};d.Cx=function(a){return db(this.se,a)};d.ne=function(a){if(Za(this.dd,a))return!1;this.dd.push(a);return!0};d.Jm=function(a){return db(this.dd,a)};d.fW=function(a,b){Si(a)?(this.lq=a,this.lm=b):Si(this.session)&&(this.lq=this.session,this.lm=this.sinkId,this.session=a,this.sinkId=b);return this};
var Uj=function(){this.a=A("mr.cast.SessionRecords");this.jb=[]};d=Uj.prototype;d.init=function(){Ve(this)};d.Es=function(a,b){F(this.a,"Adding new session: "+b+", "+a.sessionId);var c=this.zd(a.sessionId);if(c)return c.fW(a,b);c=new Tj(b,a);this.jb.push(c);return c};d.k2=function(a){F(this.a,"Removing session "+a);this.jb=Sa(this.jb,function(b){return b.session.sessionId!=a})};d.yC=function(a){return(a=this.zd(a))?a.se:[]};d.Dp=function(a){return(a=this.Ml(a))?a.session:null};
d.Rc=function(a){return Xa(this.jb,function(b){return Za(b.se,a)})};d.Of=function(a){return Xa(this.jb,function(b){return Za(b.dd,a)})};d.JU=function(a){return Xa(this.jb,function(b){return null!=Xa(b.dd,function(b){return Jj(b).yD()==a})})};d.Ml=function(a){return Xa(this.jb,function(b){return b.sinkId==a||b.lm==a})};d.zd=function(a){return Xa(this.jb,function(b){return b.session.sessionId==a})};d.RD=function(a){return(a=this.zd(a))?a.sinkId:null};
d.jv=function(a){return(a=this.zd(a))?a.session:null};d.k6=function(a,b){var c=this.jv(a);if(c){var e=Sa(b,function(a){return a.playerState!=chrome.cast.media.En.IDLE},this);e.forEach(function(a){if(!a.media){var b=Xa(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}});c.media=e}};d.i1=function(a){for(var b=0;b<this.jb.length;b++)this.jb[b].Cx(a)};var Vj=function(a){this.Xq=a};Uj.prototype.Oa=function(){return"cast.SessionRecords"};Uj.prototype.getData=function(){return[new Vj(this.jb)]};
Uj.prototype.rb=function(){var a=Se(this);if(a)for(var b=0;b<a.Xq.length;b++){var c=a.Xq[b],e=new Tj(c.sinkId,c.session);e.se=c.se;e.dd=c.dd;e.cq=c.cq;e.lq=c.lq;e.lm=c.lm;this.jb.push(e)}};var Wj=function(a){this.Hc="sender-"+Ga();this.eb=new z;this.yh=null;Ve(this);this.B=a;this.yb=new Oj;this.ha=new Uj;this.kc=new Bj(this.Hc,this);this.Z=new ni(this.kc,this);this.sP=new Qj(this.Z);this.Oc=new Ai(this.kc,this.Hc);this.xc=new Ej(this.Oc,this.Z);this.Nc=new pj(this.Oc,this.Z,this.yb,this.ha,this.kc,this);this.wA=new Gi(this.Z,this.Oc);this.l7=this.Z.start.bind(this.Z)};d=Wj.prototype;d.a=A("mr.CastProvider");d.sV=function(){return this.Z};d.getName=function(){return"cast"};
d.Wc=function(){this.Oc.init();this.ha.init();this.Nc.init();this.kc.init();this.Z.init();this.sP.init();this.xc.init();this.B.ux(this.l7)};d.Fe=function(){return this.eb.v()};d.wl=function(a){var b=new yc;this.bp(a).forEach(function(a){this.Z.SD(a).map(function(a){return a.Jf()}).forEach(function(a){b.add(a)})}.bind(this));return new Gj(b.v(),-1!=a.indexOf("0F5096E8")?Tg:null)};d.ri=function(a){this.bp(a).forEach(function(a){this.xc.tx(a)}.bind(this));this.B.Sv()&&this.Z.start()};d.ti=function(a){this.bp(a).forEach(function(a){this.xc.Vy(a)}.bind(this))};
d.pi=function(){};d.si=function(){};d.ga=function(a){return(a=this.Z.ga(a))?a.Jf():null};d.h3=function(a){var b=new Gg(Sj,"warning","dismiss");b.routeId=a;this.B.Gf().send(b)};d.sE=function(a,b){B(this.a,"Error launching.",b);this.h3(a.id);this.B.onPresentationConnectionClosed(a.id,"error","Launch error");this.B.ag(this,a)};
d.Ho=function(a,b,c,e,f,g,k){wf.O().Wh=new vf(b.If(),b.Vb());var l=Mj(a,b,c,!0);l.forDisplay=!1;l.offTheRecord=e;this.eb.set(l.id,l);this.B.Lh(this,l);(e=nj(a))&&e.Rb()&&this.Iz(e,l.id,g,k);Sg(a)?(l.$d={tabId:k,sessionId:"",NJ:b.Vb()||"",OJ:b.If()||""},this.B.kn(this,l,function(e){return this.vF(a,b,c,f,g,k,e)}.bind(this)).then(function(){this.hJ(l)},function(a){this.sE(l,a)},this)):this.vF(a,b,c,f,g,k,l).na(function(a){this.sE(l,a)},this);return H(l)};
d.vF=function(a,b,c,e,f,g,k){return this.Nc.pw(this.dx(a,b,e),b).then(function(e){this.ne(a,b,c,e,f,g,k);return k},null,this)};d.uf=function(a,b,c,e,f,g,k){var l=this.Z.ga(b);if(!l)return I("No sink");var w=lj(a);if(w){setTimeout(function(){this.Nc.oI(w,l,chrome.cast.Tk.CAST)}.bind(this),0);var C=this.yb.Rc(w);if(C)return this.vc(C.routeId).then(function(){return this.Ho(a,l,c,e,f,g,k)},null,this);if(g&&k&&(b=this.aB(a,g,k,e,f,b)))return b}return this.Ho(a,l,c,e,f,g,k)};
d.GP=function(a,b){this.B.Gd(this,a,b)};d.FP=function(a,b){var c=this.eb.get(a);c&&c.Ui&&this.B.Cq(this,a,b)};d.Jm=function(a,b){F(this.a,"Remove route "+a);var c=this.yb.Of(a);if(c){var e=c.clientId;F(this.a,"Remove client "+e);this.ha.i1(e);this.yb.Cx(e)}if(e=this.ha.Of(a))e.Jm(a),this.NF(e.dd);var f=this.eb.get(a);f&&(f.Ui&&e&&(this.kc.NA(f.sinkId,c?c.clientId:this.Hc,e.session.transportId,b),f.forDisplay&&c&&(this.yh={Ni:c,sI:e})),this.eb.remove(a),this.B.ag(this,f))};
d.v8=function(a){a.dd.forEach(function(b){if(b=this.eb.get(b)){var c=a.session;b.$d&&b.forDisplay?this.hJ(b):(b.description=c.statusText||c.displayName,this.B.bg(this,b))}}.bind(this))};d.p8=function(a){Ua(a,function(a){a=this.eb.get(a,null);if(!a||!a.mediaSource)return!1;var c=nj(a.mediaSource),c=c?c.eD():!1;return a.isLocal&&!c},this)&&v(a,function(a){if(a=this.eb.get(a,null))a.isLocal=!0},this)};
d.NF=function(a){var b=[],c=[],e=null;a.forEach(function(a){if(a=this.eb.get(a))a.forDisplay=!1,a.Ui?e||jj(a.mediaSource,"__castAutoJoinPolicy__")==chrome.cast.ke.CUSTOM_CONTROLLER_SCOPED||(b.push(a),e=a.sinkId):e&&e!=a.sinkId?b.push(a):c.push(a)}.bind(this));v(0<b.length?b:c,function(a){a.forDisplay=!0})};d.Iz=function(a,b,c,e){var f=a.Rb();f&&!this.yb.Rc(f)&&(F(this.a,"Add client "+f),this.yb.Cs(b,f,a.ap(),a.pC(),c||null,m(e)?e:null))};
d.hJ=function(a){var b=this.ha.Of(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.ne=function(a,b,c,e,f,g,k){var l=null!=a,w;null==a?(w=new hj([{appId:e.appId,capabilities:e.capabilities}]),a=w.toString()):w=nj(a);a=k||Mj(a,b,c||e.sessionId,l);l=a.id;F(this.a,"Add route "+l);c=null;w&&(c=w.Rb(),this.Iz(w,l,f,g));(f=this.ha.Ml(b.getId()))||(f=this.ha.Es(e,b.getId()));f.ne(l);a.Ui&&this.kc.O_(b,c||this.Hc,e.transportId,!(w&&w.eD()));f.offTheRecord=a.offTheRecord;this.eb.set(l,a);w=f.dd;this.p8(w);this.NF(w);w=e.sessionId;g=e.appId;("0F5096E8"==g||"85CDB22F"==g)&&w&&a.$d&&(a.$d.sessionId=
w);!Qi(e,Vh)||null!==e&&Za(Ri,e.appId)||(a.customControllerPath="cast_route_details.html?"+["sessionId="+w,"appId="+g].join("&"));a.description=e.statusText||e.displayName;k?this.B.bg(this,a):this.B.Lh(this,a);c&&f.Cs(c)&&this.Nc.WZ(e,b,c);return a};
d.vc=function(a){var b=this.eb.get(a);if(!b)return H();var c=this.ha.Of(a);if(!c)return F(this.a,"Session for route "+a+" does not exist."),this.Jm(a,!0),H();var e=this.Z.ga(b.sinkId);if(!e)return F(this.a,"Sink for route "+a+" is no longer reachable."),this.Nc.hk(c.sinkId,"close-route"),H();(a=this.yb.Of(a))&&this.Nc.oI(a.clientId,e,chrome.cast.Tk.STOP);ci(0);var f=J();this.Oc.x2(c.session.sessionId,e).Va(function(){this.Nc.hk(e.getId(),"close-route");f.resolve()},this);return f.promise};
d.FQ=function(a){var b=null;nc(this.eb.sv(),function(c){if(!c.Ui)return!1;var e=this.Z.ga(c.sinkId);if(!e||!a.OX(this.dx(c.mediaSource,e)))return!1;b=c;return!0},this);if(!b||!b.mediaSource)return null;var c=oj(b.mediaSource);if(!c)return null;var e=this.yb.Rc(c);return e?(c=this.ha.Rc(c))?{Ni:e,sI:c}:null:null};
d.fN=function(a,b,c){var e=this.FQ(a);if(!e){if(!this.yh||this.yh.Ni.origin!=b||this.yh.Ni.tabId!=c)return null;e=this.yh}switch(a.pC()){case chrome.cast.ke.PAGE_SCOPED:return null;case chrome.cast.ke.ORIGIN_SCOPED:if(b!=e.Ni.origin)return null;break;case chrome.cast.ke.TAB_AND_ORIGIN_SCOPED:if(b!=e.Ni.origin||c!=e.Ni.tabId)return null}return this.ha.zd(e.sI.session.sessionId)};
d.aB=function(a,b,c,e,f,g){var k=null;nc(this.eb.sv(),function(a){var b=a.$d;return b&&null!=b.tabId&&b.tabId==c&&Rg(a.mediaSource)?(k=a,!0):!1});return k?this.vc(k.id).then(function(){return this.uf(a,g||k.sinkId,"",e,f,b,null==c?void 0:c)},null,this):null};
d.Lg=function(a,b,c,e,f){if(!nj(a))return I(Error("Unsupported presentation URL"));b=Jj(b);b=this.ha.zd(b.yD());if(!b)return I(Error("No matching route"));var g=this.Z.ga(b.sinkId);if(!g)return I(Error("No sink"));a=this.ne(a,g,c,b.session,e,f);return H(a)};
d.xh=function(a,b,c,e,f,g){var k=nj(a);if(!k)return I(Error("Unsupported presentation URL"));var l;if(b==chrome.cast.gL){if(l=this.fN(k,f,g),!l&&k.QR()!=chrome.cast.Dn.CAST_THIS_TAB&&(e=this.aB(a,f,g,c,e)))return e}else l=0==b.indexOf(chrome.cast.vz)?this.ha.zd(b.substr(chrome.cast.vz.length)):this.ha.JU(b);if(!l)return I(Error("No matching route"));if(l.offTheRecord!=c)return I(Error("Off the record mismatch"));e=this.Z.ga(l.sinkId);if(!e)return I(Error("No sink"));a=this.ne(a,e,b,l.session,f,g);
a.offTheRecord=c;return H(a)};d.yf=function(a){this.Jm(a,!1)};d.Hf=function(a){var b=!0,c=!0;if(a=this.Z.ga(a))b=a.yl(),c=!!(b&1),b=!!(b&4);return Dh(b,c)};d.Gl=function(){return"cast_streaming"};
d.lg=function(a,b,c){if(!c)return this.Nc.Gd(a,b),H();var e=this.ha.Of(a);if(!e)return I(Error("Not managing the route "+a));var f=this.Z.ga(e.sinkId);if(!f)return I(Error("Sink no longer accessible"));a=(a=this.yb.Of(a))?a.clientId:this.Hc;var g=J();this.kc.hr(f,c.namespace,b,a,e.session.transportId).Va(function(){g.resolve()});return g.promise};d.$k=function(a,b){var c=this.Z.ga(b);if(!c)return!1;a=this.dx(a,c);var e=mj(a);return e&&0!=e.length?Ua(e,function(a){return fi(c.Rd(a))}):!1};
d.Ki=function(a,b){var c=this.bp(a);if(!c||0==c.length)return!1;if(b&&b.mediaSource){var e=mj(b.mediaSource);return Ua(e,function(a){return Za(c,a)},this)}return!0};d.fV=function(a){return(a=this.eb.get(a))?lj(a.mediaSource):null};d.dx=function(a,b,c){return Sg(a)?(a={appId:0==(b.yl()&1)?"85CDB22F":"0F5096E8",capabilities:Mi(b.yl())},(new hj([a],void 0,void 0,void 0,c)).toString()):a};d.bp=function(a){var b=[];Sg(a)?(b.push("85CDB22F"),b.push("0F5096E8")):(a=mj(a))&&(b=gb(b,a));return b};
d.Gw=function(a){this.Z.Gw(a.getId());ci(2)};d.pZ=function(a){this.Nc.sH(a,!0)};d.nZ=function(a,b){this.wA.mW(a,b);this.Nc.q_(a.getId(),b)};d.Ne=function(a){this.B.onSinkAvailabilityUpdated(this,1);this.be(a);this.Nc.sH(a)};d.Eq=function(a){if(0==this.Z.oc().length)this.B.onSinkAvailabilityUpdated(this,0);this.Nc.Eq(a.getId());this.tE()};d.be=function(a){this.xc.Rm(a);this.tE()};d.tE=function(){this.wA.OW();this.B.qc()};var Xj=function(a,b,c){this.rI=a;this.routes=b;this.YX=c};Wj.prototype.Oa=function(){return"cast.Provider"};
Wj.prototype.getData=function(){return[new Xj(this.Hc,this.eb.b(),this.yh)]};Wj.prototype.rb=function(){var a=Se(this);a&&(this.Hc=a.rI,this.eb.addAll(a.routes),this.yh=a.YX)};var Yj=function(){if(!Cc)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}},Zj=Cc&&Yj();var ak=function(){this.vd=[];this.Pd=[]};d=ak.prototype;d.xY=function(){0==this.vd.length&&(this.vd=this.Pd,this.vd.reverse(),this.Pd=[])};d.enqueue=function(a){this.Pd.push(a)};d.xf=function(){this.xY();return this.vd.pop()};d.M=function(){return this.vd.length+this.Pd.length};d.Qa=function(){return 0==this.vd.length&&0==this.Pd.length};d.clear=function(){this.vd=[];this.Pd=[]};d.contains=function(a){return Za(this.vd,a)||Za(this.Pd,a)};
d.remove=function(a){var b;b=this.vd;var c=Qa(b,a);0<=c?(cb(b,c),b=!0):b=!1;return b||db(this.Pd,a)};d.v=function(){for(var a=[],b=this.vd.length-1;0<=b;--b)a.push(this.vd[b]);for(var c=this.Pd.length,b=0;b<c;++b)a.push(this.Pd[b]);return a};var bk=function(a,b){ae.call(this);this.cG=a||0;this.Dh=b||10;if(this.cG>this.Dh)throw Error("[goog.structs.Pool] Min can not be greater than max");this.Lb=new ak;this.Sf=new yc;this.Gt=0;this.aw=null;this.Ln()};u(bk,ae);d=bk.prototype;d.getObject=function(){var a=t();if(!(null!=this.aw&&a-this.aw<this.Gt)){var b=this.b2();b&&(this.aw=a,this.Sf.add(b));return b}};d.Xh=function(a){return this.Sf.remove(a)?(this.Ds(a),!0):!1};
d.b2=function(){for(var a;0<this.UC()&&(a=this.Lb.xf(),!this.Fw(a));)this.Ln();!a&&this.M()<this.Dh&&(a=this.we());return a};d.Ds=function(a){this.Sf.remove(a);this.Fw(a)&&this.M()<this.Dh?this.Lb.enqueue(a):this.Sg(a)};d.Ln=function(){for(var a=this.Lb;this.M()<this.cG;)a.enqueue(this.we());for(;this.M()>this.Dh&&0<this.UC();)this.Sg(a.xf())};d.we=function(){return{}};d.Sg=function(a){if("function"==typeof a.hb)a.hb();else for(var b in a)a[b]=null};
d.Fw=function(a){return"function"==typeof a.$N?a.$N():!0};d.contains=function(a){return this.Lb.contains(a)||this.Sf.contains(a)};d.M=function(){return this.Lb.M()+this.Sf.M()};d.$S=function(){return this.Sf.M()};d.UC=function(){return this.Lb.M()};d.Qa=function(){return this.Lb.Qa()&&this.Sf.Qa()};d.K=function(){bk.R.K.call(this);if(0<this.$S())throw Error("[goog.structs.Pool] Objects not released");delete this.Sf;for(var a=this.Lb;!a.Qa();)this.Sg(a.xf());delete this.Lb};var ck=function(a,b){this.hq=a;this.vi=b};ck.prototype.getKey=function(){return this.hq};ck.prototype.Xb=function(){return this.vi};ck.prototype.clone=function(){return new ck(this.hq,this.vi)};var dk=function(a){this.$c=[];a&&this.nX(a)};d=dk.prototype;d.insert=function(a,b){var c=this.$c;c.push(new ck(a,b));this.TY(c.length-1)};d.nX=function(a){var b;if(a instanceof dk){if(b=a.Xa(),a=a.v(),0>=this.M()){for(var c=this.$c,e=0;e<b.length;e++)c.push(new ck(b[e],a[e]));return}}else b=wb(a),a=vb(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.$c,b=a.length,c=a[0];if(!(0>=b))return 1==b?$a(a):(a[0]=a.pop(),this.SY(0)),c.Xb()};
d.SY=function(a){for(var b=this.$c,c=b.length,e=b[a];a<c>>1;){var f=this.kT(a),g=this.dV(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.TY=function(a){for(var b=this.$c,c=b[a];0<a;){var e=this.mU(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.kT=function(a){return 2*a+1};d.dV=function(a){return 2*a+2};d.mU=function(a){return a-1>>1};d.v=function(){for(var a=this.$c,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].Xb());return b};
d.Xa=function(){for(var a=this.$c,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.Si=function(a){return Ua(this.$c,function(b){return b.Xb()==a})};d.Ja=function(a){return Ua(this.$c,function(b){return b.getKey()==a})};d.clone=function(){return new dk(this)};d.M=function(){return this.$c.length};d.Qa=function(){return 0==this.$c.length};d.clear=function(){$a(this.$c)};var ek=function(){dk.call(this)};u(ek,dk);ek.prototype.enqueue=function(a,b){this.insert(a,b)};ek.prototype.xf=function(){return this.remove()};var fk=function(a,b){this.hB=void 0;this.cr=new ek;bk.call(this,a,b)};u(fk,bk);d=fk.prototype;d.getObject=function(a,b){if(!a){var c=fk.R.getObject.call(this);c&&this.Gt&&(this.hB=h.setTimeout(r(this.Np,this),this.Gt));return c}this.cr.enqueue(m(b)?b:100,a);this.Np()};d.Np=function(){for(var a=this.cr;0<a.M();){var b=this.getObject();if(b)a.xf().apply(this,[b]);else break}};d.Ds=function(a){fk.R.Ds.call(this,a);this.Np()};d.Ln=function(){fk.R.Ln.call(this);this.Np()};
d.K=function(){fk.R.K.call(this);h.clearTimeout(this.hB);this.cr.clear();this.cr=null};var gk=function(a,b,c,e){this.uh=a;this.Ai=!!e;fk.call(this,b,c)};u(gk,fk);gk.prototype.we=function(){var a=new Ff,b=this.uh;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.Ai&&a.Ay(!0);return a};gk.prototype.Fw=function(a){return!a.isDisposed()&&!a.Je()};var hk=function(a,b,c,e,f,g){L.call(this);this.Le=m(a)?a:1;this.ef=m(f)?Math.max(0,f):0;this.Qk=new gk(b,c,e,g);this.$b=new z;this.Ga=new Gh(this)};u(hk,L);var ik="ready complete success error abort timeout".split(" ");d=hk.prototype;d.zr=function(a){this.ef=Math.max(0,a)};d.send=function(a,b,c,e,f,g,k,l,w,C){if(this.$b.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new jk(b,r(this.sW,this,a),c,e,f,k,m(l)?l:this.Le,w,C);this.$b.set(a,b);a=r(this.iW,this,a);this.Qk.getObject(a,g);return b};
d.abort=function(a,b){var c=this.$b.get(a);if(c){var e=c.ps;c.A3(!0);b&&(e&&(this.JH(e,c.tv()),Ce(e,"ready",function(){this.Qk.Xh(e)},!1,this)),this.$b.remove(a));e&&e.abort()}};d.iW=function(a,b){var c=this.$b.get(a);c&&!c.ps?(this.TM(b,c.tv()),b.zr(this.ef),b.uJ(c.ID()),b.Ay(c.lE()),c.ps=b,this.dispatchEvent(new kk("ready",this,a,b)),this.VH(a,b),c.OQ()&&b.abort()):this.Qk.Xh(b)};
d.sW=function(a,b){var c=b.target;switch(b.type){case "ready":this.VH(a,c);break;case "complete":return this.pW(a,c,b);case "success":this.RW(a,c);break;case "timeout":case "error":this.Xl(a,c);break;case "abort":this.gW(a,c)}return null};d.VH=function(a,b){var c=this.$b.get(a);!c||c.GR()||c.Dv()?(c&&(this.JH(b,c.tv()),this.$b.remove(a)),this.Qk.Xh(b)):(c.eX(),b.send(c.getUrl(),c.QT(),c.kp(),c.pp()))};
d.pW=function(a,b,c){var e=this.$b.get(a);if(7==b.Iu()||b.Cd()||e.Dv())if(this.dispatchEvent(new kk("complete",this,a,b)),e&&(e.X3(!0),e.EC()))return e.EC().call(b,c);return null};d.gW=function(a,b){this.dispatchEvent(new kk("abort",this,a,b))};d.RW=function(a,b){this.dispatchEvent(new kk("success",this,a,b))};d.Xl=function(a,b){this.$b.get(a).Dv()&&this.dispatchEvent(new kk("error",this,a,b))};d.JH=function(a,b,c){this.Ga.Mc(a,c||ik,b)};d.TM=function(a,b,c){this.Ga.listen(a,c||ik,b)};
d.K=function(){hk.R.K.call(this);this.Qk.hb();this.Qk=null;this.Ga.hb();this.Ga=null;this.$b.clear();this.$b=null};var kk=function(a,b,c,e){K.call(this,a,b);this.id=c;this.ps=e};u(kk,K);var jk=function(a,b,c,e,f,g,k,l,w){this.bs=a;this.MY=c||"GET";this.hl=e;this.uh=f||null;this.Le=m(k)?k:1;this.dA=0;this.Ez=this.SA=!1;this.Z8=b;this.KO=g;this.ik=l||"";this.Ai=!!w;this.ps=null};d=jk.prototype;d.getUrl=function(){return this.bs};d.QT=function(){return this.MY};d.kp=function(){return this.hl};d.pp=function(){return this.uh};
d.lE=function(){return this.Ai};d.tp=function(){return this.Le};d.eX=function(){this.dA++};d.Dv=function(){return this.dA>this.Le};d.X3=function(a){this.SA=a};d.GR=function(){return this.SA};d.A3=function(a){this.Ez=a};d.OQ=function(){return this.Ez};d.tv=function(){return this.Z8};d.EC=function(){return this.KO};d.ID=function(){return this.ik};var lk=function(){this.name="unknown";this.state="error";this.rX=null;this.allowStop=!0;this.serviceData=this.ai=null;this.extraData={}},ok=function(a,b,c){this.Jc=a;(a=b)||(mk||(mk=new hk(3,null,1,10,2E3)),a=mk);this.Cn=a;this.Rk=[];c||(nk||(nk=new hk(0,null,1,10,15E3)),c=nk);this.fL=c;this.a=A("mr.dial.Client")};ok.prototype.abort=function(){this.Rk.forEach(function(a){this.Cn.abort(a,!0);this.fL.abort(a,!0)},this)};var mk=null,nk=null,pk=999;
ok.prototype.launchApp=function(a,b){var c=J(),e=(++pk).toString();this.Rk.push(e);this.fL.send(e,this.mu(a),"POST",b,null,0,this.QB("launchApp","POST",e,c));return c.promise};ok.prototype.ZJ=function(a){var b=J(),c=(++pk).toString();this.Rk.push(c);this.Cn.send(c,this.mu(a),"DELETE",null,null,0,this.QB("stopApp","DELETE",c,b),0);return b.promise};var qk=function(a,b){this.Y8=a;this.jf=b};
ok.prototype.lu=function(a){return new Od(function(b){var c=(++pk).toString();this.Rk.push(c);this.Cn.send(c,this.mu(a),"GET",null,null,0,r(this.BZ,this,c,b))},this)};
ok.prototype.BZ=function(a,b,c){db(this.Rk,a);a=c.target;yf(this.a,"GetAppInfo","GET",a,!0);if(a.Cd()){c=a.JD();if(!c)if(c=a.zp(),"undefined"!=typeof DOMParser)c=(new DOMParser).parseFromString(c,"application/xml");else if(Zj){var e=new ActiveXObject("MSXML2.DOMDocument");e.resolveExternals=!1;e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",2048),e.setProperty("MaxElementDepth",256)}catch(l){}e.loadXML(c);c=e}else throw Error("Your browser does not support loading xml documents");
if(c)if((e=c.getElementsByTagName("service"))&&1==e.length){c=new lk;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.ai=k.getAttribute("href"):"options"==k.nodeName?c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)F(this.a,
"GET response missing name value"),b(new qk(a,null));else if("error"==c.state)F(this.a,"GET response missing state value"),b(new qk(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.rX=e[1];else if("running"!=c.state&&"stopped"!=c.state){F(this.a,"GET response has invalid state value");b(new qk(a,null));return}b(new qk(a,c))}}else F(this.a,"Invalid GET response (invalid service)"),b(new qk(a,null));else F(this.a,"Empty response"),b(new qk(a,null))}else F(this.a,"Request to "+
a.rp()+" failed"),b(new qk(a,null))};ok.prototype.mu=function(a){var b=this.Jc.fS();"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};ok.prototype.QB=function(a,b,c,e){return r(function(f){db(this.Rk,c);f=f.target;yf(this.a,a,b,f,!0);f.Cd()?e.resolve():e.reject(Error(zf(f.Iu())))},this)};var rk=function(a,b,c){this.appName=b;this.launchParameter=c||""},sk=A("mr.DialProvider"),uk=function(a){if(qa(a,"urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new rk(a,c,0<b?a.substring(b+1):void 0):null}else a=tk(a);return a},vk=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,wk=/__dialPostData__=([A-Za-z0-9]+={0,2})/,tk=function(a){var b=(new Xi(a)).kj();if(!b)return null;var c=vk.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);
if(b=(b=wk.exec(b))?b[1]:void 0)try{b=sf(b)}catch(e){return E(sk,"Invalid base64 encoded postData:"+b),null}return new rk(a,c,b)};var xk=function(a,b){this.Ca=a;this.appName=b};var yk=function(a){this.Ve={};this.Hn=a};d=yk.prototype;d.init=function(){Ve(this)};d.clear=function(){this.Ve={}};d.add=function(a){this.fp(a.Ca.id)||(this.Ve[a.Ca.id]=a,this.Hn.ZY(a))};d.update=function(a,b,c,e){a=this.fp(a);var f=!1;"boolean"==typeof e&&(f=f||a.Ca.allowStop!=e,a.Ca.allowStop=e);f=f||a.Ca.description!=b||a.Ca.iconUrl!=c;a.Ca.description=b||"";a.Ca.iconUrl=c;f&&this.Hn.$Y(a)};d.fp=function(a){return this.Ve[a]||null};
d.kR=function(a){return Ab(this.Ve,function(b){return b.Ca.sinkId==a})||null};d.X1=function(a){if(a=this.kR(a))delete this.Ve[a.Ca.id],this.Hn.lG(a)};d.W1=function(a){var b=this.fp(a);delete this.Ve[a];b&&this.Hn.lG(b)};d.Fe=function(){return vb(sb(this.Ve,function(a){return a.Ca}))};d.Oa=function(){return"dial.ActivityRecords"};d.getData=function(){return[this.Ve]};d.rb=function(){this.Ve=Se(this)||{}};var zk={l$:0,uba:1,Daa:2},Ak={ERROR:0,Waa:1,EMPTY:2},Bk=function(a){Mg("MediaRouter.Dial.Create.Route",a,zk)},Ck=function(a){Mg("MediaRouter.Dial.Device.Description.Failure",a,Ak)};var Dk=function(a,b){this.a=A("mr.dial.AppDiscoveryService");this.Ib=new yc;this.Z=a;this.uP=b;this.tb=new yc;this.jo=new z;this.Lc=null;this.di=!1};d=Dk.prototype;d.init=function(){Ve(this);this.Ib.addAll(this.uP)};d.start=function(){!this.di&&0<this.Ib.M()&&(this.di=!0,this.Lt())};d.stop=function(){this.di&&(this.di=!1,this.Lc&&clearTimeout(this.Lc),this.jo.v().forEach(function(a){a.abort()}))};
d.tx=function(a){if(!this.Ib.contains(a)||this.VM(a))this.Ib.add(a),this.di&&this.tb.Qa()?(this.Lc&&(clearTimeout(this.Lc),this.Lc=null),this.Lt()):this.di||this.start()};d.Vy=function(a){this.Ib.remove(a);this.Ib.Qa()&&this.stop()};d.NU=function(){return this.Ib.v()};d.kC=function(){return this.Ib.M()};d.Lt=function(){F(this.a,"Start app status scan.");this.Z.oc().forEach(this.Rm,this)};d.PP=function(){this.tb.Qa()&&(G(this.a,"Start app status scan (timer-based)"),this.Lc=null,this.Lt())};
d.Rm=function(a){a.I7()&&this.Ib.v().forEach(function(b){this.ot(a,b).then(function(){this.Z.iZ(b,a)},ca,this)},this)};d.gS=function(a){if(!this.jo.Ja(a.getId())){var b=new ok(a);G(this.a,"Created DIAL client for "+a.getId());this.jo.set(a.getId(),b);return b}return this.jo.get(a.getId())};d.KP=function(a,b){return this.gS(a).lu(b).then(function(c){return this.CZ(a,b,c.Y8,c.jf)},function(){G(this.a,"Failed to get app availablity; "+a.getId()+" does not support app availability");a.sy(!1)},this)};
d.CZ=function(a,b,c,e){G(this.a,"DIAL get app info result: "+JSON.stringify(e));if(404==c.Ya())return"unavailable";if(!e)throw G(this.a,"Failed to process app availability; "+a.getId()+" does not support app availability"),a.sy(!1),Error("Unable to get application info for app "+b+" on sink "+a.getId());if("Netflix"==b)return this.OP(e);switch(e.state){case "running":case "stopped":return"available";default:return"unavailable"}};
d.OP=function(a){return a.extraData&&m(a.extraData.capabilities)&&"websocket"==a.extraData.capabilities&&("running"==a.state||"stopped"==a.state)?"available":"unavailable"};var Ek=function(a,b){return a.getId()+":"+b};d=Dk.prototype;
d.ot=function(a,b){if("unknown"!=a.Rd(b)&&36E5>t()-a.VQ(b))return I(Error("App status already known and not expired"));var c=Ek(a,b);if(this.tb.contains(c))return I(Error("Duplicate request"));var e=a.Rd(b);G(this.a,"Querying "+a.getId()+" for "+b);this.tb.add(c);return this.KP(a,b).then(function(c){G(this.a,"Got app status "+c+" from "+a.getId()+" for "+b);if(c!=e)return a.mr(b,c),c;throw Error("Same app status");},null,this).Va(function(){this.tb.remove(c);this.di&&this.tb.Qa()&&!this.Lc&&(this.Lc=
setTimeout(this.PP.bind(this),6E4))},this)};d.VM=function(a){return this.Z.oc().some(function(b){return"unknown"==b.Rd(a)})};d.Oa=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.NU()]};d.rb=function(){var a=Se(this);this.Ib.addAll(a||[])};var Fk=function(){this.configId=this.modelName=this.deviceType=this.Zt=this.au=this.Tn=this.ipAddress=this.friendlyName=this.deviceLabel=this.wn=null};Fk.prototype.K8=function(){return this.deviceLabel?this.wn?this.friendlyName?this.ipAddress?this.Tn?this.au?this.Zt?null:"Missing expireTimeMillis":"Missing fetchTimeMillis":"Missing appUrl":"Missing ipAddress":"Missing friendlyName":"Missing uniqueId":"Missing deviceLabel"};
Fk.prototype.toString=function(){return JSON.stringify(this,function(a,b){return p(b)&&0==b.indexOf("uuid:")?"***":b})};var Ik=function(a){this.et=new z;this.tb=new yc;this.$w=new z;var b;(b=a)||(Gk||(Gk=new hk(3,null,1,10,2E3)),b=Gk);this.Cn=b;a||(Hk||(Hk=new hk(2,null,1,10,3E3)),a=Hk);this.yM=a;this.a=A("mr.dial.DeviceDescriptionService")},Gk=null,Hk=null;d=Ik.prototype;
d.cS=function(a){var b=this.rO(a);return b?(Lg("MediaRouter.Dial.Device.Description.Cached"),H(b)):this.tb.contains(a.deviceLabel)?I(Error("Duplicate request for device "+a.deviceLabel)):this.vQ(a)};d.rO=function(a){var b=this.et.get(a.deviceLabel);return b?b.configId!=a.configId||t()>=b.Zt?(G(this.a,"Removing invalid entry "+b.toString()),this.et.remove(a.deviceLabel),null):b:null};
d.vQ=function(a){var b=J();this.tb.add(a.deviceLabel);this.Cn.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,r(function(c){(c=this.$0(a,c))?b.resolve(c):b.reject(Error("Failed to get device description"))},this));return b.promise};
d.$0=function(a,b){this.tb.remove(a.deviceLabel);var c=b.target;yf(this.a,"fetchDeviceDescription","GET",c);if(!c.Cd())return F(this.a,"Request to "+c.rp()+" failed"),Ck(0),null;var e=c.JD();if(!e)return F(this.a,"Invalid or empty response"),Ck(2),null;c=this.h0(c,a,e);if(!c)return Ck(1),F(this.a,"Invalid device description"),null;F(this.a,"Got device description for "+c.deviceLabel);G(this.a,"... device description was: "+c.toString());null!=c.configId&&(G(this.a,"Caching device description for "+
c.deviceLabel),this.et.set(a.deviceLabel,c));return c};
d.h0=function(a,b,c){var e=new Fk;e.au=t();e.Zt=e.au+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.Tn=a.getResponseHeader("Application-URL")||null;a=e.Tn;a=a instanceof Xi?a.clone():new Xi(a,void 0);e.ipAddress=a.Df();e.deviceType=Jk(c,"deviceType");e.modelName=Jk(c,"modelName");e.friendlyName=Jk(c,"friendlyName");if(a=e.friendlyName)200<a.length&&(a=a.substring(0,197)+"..."),Ba.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(va,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(wa,"&lt;")),-1!=a.indexOf(">")&&
(a=a.replace(xa,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(ya,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(za,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Aa,"&#0;")));e.friendlyName=a;e.wn=Jk(c,"UDN");a=e.K8();G(this.a,"Device description: "+Kk(c));return a?(E(this.a,"Device description failed to validate ("+a+"): "+JSON.stringify(e)),null):e};
var Jk=function(a,b){var c=a.getElementsByTagName(b);return c&&0!=c.length?c[0].textContent:null},Kk=function(a){var b=function(a){for(var b=0,f=a.length;b<f;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
Ik.prototype.cl=function(a){var b=this.$w.get(a);if(b)return b.promise;b=J();this.$w.set(a,b);this.yM.send(a,a,"GET",null,null,0,r(function(c){this.$w.remove(a);c=c.target;yf(this.a,"checkAccess","GET",c,!1);b.resolve(c.Cd())},this));return b.promise};var Lk=function(a,b){this.hn=a;this.kB=b||new Ik;this.a=A("mr.dial.SinkDiscoveryService");this.Jd=new z;this.Qg=r(this.xZ,this);this.yB=r(this.z_,this);this.Aq=this.Kj=!1},Mk={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"};d=Lk.prototype;d.init=function(){Ve(this)};
d.start=function(){this.Kj||(F(this.a,"Starting..."),chrome.dial?(chrome.dial.onDeviceList.addListener(this.Qg),chrome.dial.onError.addListener(this.yB),this.Kj=!0,this.refresh()):(Lg("MediaRouter.Dial.No.Dial.Api"),E(this.a,"Dial API not available, aborting start..."),this.Kj=!1))};d.stop=function(){this.Kj?(this.Kj=!1,chrome.dial.onDeviceList.removeListener(this.Qg),chrome.dial.onError.removeListener(this.yB)):F(this.a,"Was not started.")};
d.refresh=function(){this.Kj?chrome.dial.discoverNow(r(function(a){F(this.a,"chrome.dial.discoverNow = "+a)},this)):F(this.a,"Not started. Ignoring discover().")};d.xZ=function(a){F(this.a,"onDeviceList returned "+a.length+" devices");G(this.a,"....the list is: "+JSON.stringify(a));this.Aq=!1;var b=[],c=new yc;a.forEach(function(a){b.push(this.a1(a).then(function(a){c.add(a.getId());this.vY(a)},ca,this))},this);Ud(b).Va(function(){this.Aq||this.Qq(c)},this)};
d.vY=function(a){if(!this.Aq){G(this.a,"mayAddSink, id = "+a.getId());var b=this.Jd.get(a.getId());b?b.update(a)&&(G(this.a,"Updated sink "+b.getId()),this.hn.be(b)):(G(this.a,"Adding new sink "+a.getId()),xd(this.a,pd,"...sink was "+a.hK()),this.Jd.set(a.getId(),a),this.hn.Ne(a))}};d.Qq=function(a){this.Jd.v().forEach(function(b){a.contains(b.getId())||this.qO(b).then(function(a){a||(this.hn.cg([b]),this.Jd.remove(b.getId()))},null,this)},this)};
d.qO=function(a){return a.NC()?this.kB.cl(a.NC()):H(!1)};d.a1=function(a){return this.kB.cS(a).then(function(b){var c;b.wn?(c=b.wn,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.wn?wf.O().Wo(c):a.deviceLabel,f=Nk.test(b.modelName);return(new hi(b.friendlyName,c)).qr(e).M4(b.ipAddress).l4(b.Tn).k4(a.deviceDescriptionUrl).g5(b.modelName).sy(!f).w6(!f)},null,this)};var Nk=/Eureka Dongle|Chromecast Audio/i;d=Lk.prototype;
d.z_=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":E(this.a,"DIAL error: "+a.code+". Clear device list now.");this.hn.cg(this.Jd.v());this.Jd.clear();this.Aq=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":E(this.a,"DIAL error: "+a.code+". Keep device list.");break;default:E(this.a,"Unhandled DIAL error: "+a.code)}};d.ga=function(a){return this.Jd.get(a,null)};
d.tV=function(a){var b=[];this.oc().forEach(function(c){"available"==c.Rd(a)&&b.push(c.Jf())});var c=Mk[a];return new Gj(b,c?[c]:void 0)};d.oc=function(){return this.Jd.v()};d.lv=function(){return this.Jd.M()};d.iZ=function(a,b){this.hn.be(b)};d.Oa=function(){return"dial.DialSinkDiscoveryService"};d.getData=function(){return[this.Jd.b()]};d.rb=function(){var a=Se(this);if(a)for(var b in a)this.Jd.set(b,ii(a[b]))};var Ok=function(a,b,c){this.B=a;this.hc=b||new Lk(this);this.xc=c||new Dk(this.hc,[]);this.Di=new yk(this);this.R2=new zi("dial.RouteIdGenerator")};d=Ok.prototype;d.a=A("mr.DialProvider");d.getName=function(){return"dial"};d.Wc=function(){this.R2.vB();this.Di.init();this.hc.init();this.xc.init();this.vq()};d.wl=function(a){G(this.a,"GetAvailableSinks for "+a);return(a=uk(a))?this.hc.tV(a.appName):Hj};d.ri=function(a){if(a=uk(a))this.xc.tx(a.appName),this.vq()};
d.ti=function(a){if(a=uk(a))this.xc.Vy(a.appName),this.vw()};d.pi=function(){this.vq()};d.si=function(){this.vw()};d.vw=function(){0!=this.hc.lv()&&0!=this.xc.kC()||this.xc.stop()};d.vq=function(){this.hc.start();0<this.hc.lv()&&0<this.xc.kC()&&this.xc.start()};d.ga=function(a){return(a=this.hc.ga(a))?a.Jf():null};d.Fe=function(){return this.Di.Fe()};
d.uf=function(a,b,c,e){var f=this.hc.ga(b);if(!f)return Bk(0),I(Error("Unkown sink: "+b));wf.O().Wh=new vf(f.If(),f.Vb());var g=uk(a);if(!g)return I(Error("No app name set."));f.rr(!0);var k=g.appName,l=new ok(f);return l.lu(k).then(function(a){if(!a.jf)throw Bk(2),Error("Failed to get app info");if("running"==a.jf.state)return l.ZJ(k)},null,this).then(function(){return l.launchApp(k,g.launchParameter)},null,this).then(function(){Bk(1);return this.ne(b,a,!0,k,c,e)},null,this).Va(function(){f.rr(!1)})};
d.xh=function(){return I(Error("no supported"))};d.Lg=function(){return I(Error("no supported"))};d.yf=function(){};d.ne=function(a,b,c,e,f,g){a=Lj(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.Di.add(new xk(a,e));return a};d.Ne=function(a){this.B.onSinkAvailabilityUpdated(this,1);this.vq();this.xc.Rm(a);this.B.qc();wf.O().Vh=new vf(a.If(),a.Vb())};d.cg=function(a){if(0==this.hc.lv())this.B.onSinkAvailabilityUpdated(this,0);this.vw();a.forEach(function(a){this.Di.X1(a.getId())},this);this.B.qc()};
d.be=function(){this.B.qc()};d.ZY=function(a){this.B.Lh(this,a.Ca)};d.lG=function(a){a=a.Ca;if(a.isLocal&&!a.mediaSource.startsWith("urn:dial-multiscreen-org:dial:application:"))this.B.onPresentationConnectionStateChanged(a.id,"terminated");this.B.ag(this,a)};d.$Y=function(a){this.B.bg(this,a.Ca)};d.vc=function(a){var b=this.Di.fp(a);if(!b)return H();this.Di.W1(a);a=this.hc.ga(b.Ca.sinkId);if(!a)return H();(new ok(a)).ZJ(b.appName);return H()};d.Hf=function(){return null};d.Gl=function(){return null};
d.lg=function(){return I(Error("DIAL sending message is not supported"))};d.$k=function(a,b){var c=this.hc.ga(b);if(!c||Sg(a))return!1;var e=uk(a);return e?"available"==c.Rd(e.appName):!1};d.Ki=function(){return!1};var Pk=function(a,b){this.iO=a;this.pl=b;this.nf=this.iO.sV()};d=Pk.prototype;d.RP=function(a){return this.nf.cl(a)};d.PD=function(a){var b=this.nf.ga(a.getId());return b?b:(a=a.Vb())?this.nf.rV(a,wf.O().bl||8009):null};d.Ne=function(a){var b=this.PD(a);b?di(2):(b=li(a))?this.RP(b).then(function(c){c?this.PD(a)?di(2):(this.nf.Gs(b),di(0)):(Lg("MediaRouter.Dial.Sink.Discovered.NonCast"),this.pl.Ne(a))},function(){this.pl.Ne(a)},this):this.pl.Ne(a)};
d.cg=function(a){var b=[];v(a,function(a){var e=this.nf.ga(a.getId());e?e.Zp()&&this.nf.Yq(a.getId()):b.push(a)},this);0<b.length&&this.pl.cg(b)};d.be=function(a){var b=this.nf.ga(a.getId());b?b.Zp()&&this.nf.CK(b):this.pl.be(a)};var Qk=function(a,b){this.Z=new Lk(new Pk(b,this));this.kk=new z;this.B=a;this.$x=this.Um=0;this.ow=new yc;this.Na=new Ok(this,this.Z)},Rk=/__dialAppName__/;d=Qk.prototype;d.getName=function(){return this.Na.getName()};d.Wc=function(){this.Na.Wc()};d.Fe=function(){return this.Na.Fe()};d.yG=function(){};d.wl=function(a){return this.Na.wl(a)};d.ri=function(a){this.Na.ri(a)};d.ti=function(a){this.Na.ti(a)};d.pi=function(a){this.Na.pi(a)};d.si=function(a){this.Na.si(a)};d.ga=function(a){return this.Na.ga(a)};
d.xR=function(a){return new ok(a)};d.hS=function(a){return this.Z.ga(a)};
d.MP=function(a,b,c,e){var f=uk(a),g=this.hS(b);if(!g)return I(Error("Attempting custom launch with closed route"));g.rr(!0);var k=f.appName;if(!k)return I(Error("No app name given"));var l=null;return this.xR(g).lu(k).then(function(a){if(!a.jf)return I(Error("Failed to get app info"));l=a.jf},null,this).then(function(){return this.Na.ne(b,a,!0,k,e||"",c)},null,this).then(function(b){var c={Ca:b,aF:!1,Fr:g,appName:k,jf:l,launchParameter:f.launchParameter,session:null,clientId:null};this.kk.set(b.id,
c);var e=lj(a);if(!e)return I(Error("No client ID"));this.cP(c,e);return b},null,this).Va(function(){g.rr(!1)})};d.yX=function(a){return Rk.test(a)};d.uf=function(a,b,c,e,f,g,k){return this.yX(a)?this.MP(a,b,e,c):this.Na.uf(a,b,c,e,f,g,k)};
d.vc=function(a){var b=this.kk.get(a);return b&&b.session&&b.clientId?(a={receiver:this.yt(b.Fr),action:chrome.cast.Tk.STOP},a=new Ui("receiver_action",a),a.clientId=b.clientId,this.B.Gd(this,b.Ca.id,a),a=new Ui("remove_session",b.session.sessionId,void 0),a.clientId=b.clientId,this.B.Gd(this,b.Ca.id,a),b.aF=!0,H()):this.Na.vc(a)};
d.lg=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.q2(a,e.clientId);case "custom_dial_launch":if(this.ow.contains(e.sequenceNumber))return this.tZ(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.vc(a),H()}return this.Na.lg(a,b,c)};d.gU=function(){var a=String(this.$x);this.$x=(this.$x+1)%9007199254740992;return a};
d.cP=function(a,b){var c=this.yt(a.Fr),e=new Ui("receiver_action",{receiver:c,action:chrome.cast.Tk.CAST});e.clientId=b;this.B.Gd(this,a.Ca.id,e);c=new chrome.cast.T(this.gU(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new Ui("new_session",c);c.clientId=b;this.B.Gd(this,a.Ca.id,c)};
d.tZ=function(a,b){this.ow.remove(b.sequenceNumber);var c=b.message,e=this.kk.get(a);if(!e)return I(Error("Unknown route"));if(c&&!c.doLaunch)return H();var f=e.Fr;if(!f)return I(Error("Custom launch response for sink that no longer exists"));var f=new ok(f),g=e.launchParameter,g=(c?c.launchParameter:null)||g;return f.launchApp(e.appName,g)};d.yt=function(a){var b=new chrome.cast.ws(a.getId(),a.Bu());b.ipAddress=a.Vb();b.receiverType=chrome.cast.Fn.DIAL;return b};
d.fU=function(){var a=this.Um;this.Um=(this.Um+1)%9007199254740992;return a};d.q2=function(a,b){var c=this.kk.get(a);if(!c)return I(Error("Unknown route"));var e=this.yt(c.Fr);e.receiverType=chrome.cast.Fn.DIAL;e=new Ui("custom_dial_launch",new chrome.cast.qz(e,c.jf.state,c.jf.extraData));e.clientId=b;e.sequenceNumber=this.fU();this.ow.add(e.sequenceNumber);this.B.Gd(this,c.Ca.id,e);return H()};d.Hf=function(a){return this.Na.Hf(a)};d.Gl=function(a){return this.Na.Gl(a)};
d.$k=function(a,b){return this.Na.$k(a,b)};d.Ki=function(a,b){return this.Na.Ki(a,b)};d.Lg=function(a,b,c,e,f){return this.Na.Lg(a,b,c,e,f)};d.xh=function(a,b,c,e,f,g){return this.Na.xh(a,b,c,e,f,g)};d.yf=function(a){var b=this.kk.get(a);this.kk.remove(a);b&&b.aF?this.Na.vc(a):this.Na.yf(a)};d.qc=function(){this.B.qc()};d.onSinkAvailabilityUpdated=function(a,b){this.B.onSinkAvailabilityUpdated(a,b)};d.Lh=function(a,b){this.B.Lh(this,b)};d.ag=function(a,b){this.B.ag(this,b)};
d.bg=function(a,b){this.B.bg(this,b)};d.Gd=function(a,b,c){this.B.Gd(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.B.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.B.onPresentationConnectionClosed(a,b,c)};d.Zu=function(a){return this.B.Zu(a)};d.fv=function(){return this.B.fv()};d.Gf=function(){return this.B.Gf()};d.Cq=function(a,b,c){this.B.Cq(this,b,c)};d.Lw=function(a){this.B.Lw(a)};d.Ne=function(a){this.Na.Ne(a)};d.cg=function(a){this.Na.cg(a)};
d.be=function(a){this.Na.be(a)};d.kn=function(){};d.ux=function(a){this.B.ux(a)};d.Sv=function(){return this.B.Sv()};var Sk=function(a,b,c){this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,Sk);else if(b=Error().stack)this.stack=b;this.errorCode=a};u(Sk,Error);var Tk=function(a,b){this.routeId=a;this.message=b};var Uk=function(a){this.Oj=a;this.Qe=new ak};d=Uk.prototype;d.enqueue=function(a){this.Qe.M()==this.Oj&&this.Qe.xf();this.Qe.enqueue(a)};d.xf=function(){return this.Qe.xf()};d.AP=function(){var a=this.Qe.v();this.Qe.clear();return a};d.Qa=function(){return this.Qe.Qa()};d.AX=function(){return this.Qe.M()==this.Oj};d.v=function(){return this.Qe.v()};var Vk=function(){this.ek={};this.Jj={};this.a=A("mr.MrRouteMessageSender")};d=Vk.prototype;d.rw=function(a){if(this.yE(a))return H(this.PT(a));var b=J();this.Jj[a]=b;return b.promise};d.Jy=function(a){(a=this.Dx(a))&&a.resolve([])};d.send=function(a,b){if(!this.zY(a,b)){var c=this.ek[a];c||(c=new Uk(50),this.ek[a]=c);c.AX()&&(E(this.a,"Queue is full; dropping oldest message"),G(this.a,"   for route "+a));c.enqueue(new Tk(a,b))}};d.ag=function(a){delete this.ek[a];(a=this.Dx(a))&&a.reject(Error("Route closed"))};
d.yE=function(a){return!!this.ek[a]&&!this.ek[a].Qa()};d.PT=function(a){return(a=this.ek[a])&&!a.Qa()?a.AP():[]};d.Dx=function(a){var b=this.Jj[a];b&&delete this.Jj[a];return b||null};d.zY=function(a,b){var c=this.Dx(a);c&&c.resolve([new Tk(a,b)]);return!!c};var Wk={Bz:0,pz:1},Xk=function(a){Mg("MediaRouter.CastStreaming.Start.Success",a,Wk)};var Yk=A("mr.mirror.cast.LogUploader"),$k=function(a,b,c){Zk("raw_events.log.gz",a,b,c);return b?"https://crash.corp.google.com/samples?stbtiq="+b:""},Zk=function(a,b,c,e){if(0==b.size)F(Yk,"Trying to upload an empty file to Crash"),e&&e(null);else{var f=new FormData;f.append("prod","Cast");f.append("ver",chrome.runtime.getManifest().version);f.append(a,b);c&&f.append("comments",c);Jf("https://clients2.google.com/cr/report",function(a){a=a.target;var b=null;a.Cd()?(b=a.zp(),F(Yk,"Upload to Crash succeeded: "+
b)):F(Yk,"Upload to Crash failed. HTTP status: "+a.Ya());e&&e(b)},"POST",f,void 0,3E4)}};var al=function(){this.dm=0};da(al);var bl=A("mr.mirror.cast.LogUtils");al.prototype.V6=function(){var a={fraction:.01,autoSubmitTimeLimitMillis:6048E5},b=a.autoSubmitTimeLimitMillis,c=t();return this.dm&&b&&c-this.dm<b?!1:Math.random()<a.fraction};
var cl=function(){this.ext="MR";this.senderProductName="Google Chrome";this.senderVersion=Qh;this.senderPlatform=Ic;this.senderUserAgent=Ob||""},dl=function(a,b,c,e){var f=new cl;f.extVersion=chrome.runtime.getManifest().version;f.extChannel="public";f.minBitrate=c.minVideoBitrate;f.maxBitrate=c.maxVideoBitrate;f.resolution=c.BT();f.minResolution=c.RT();f.resolutionChangePolicy=c.VU();f.maxFrameRate=c.maxFrameRate;f.minLatency=c.minLatencyMillis;f.maxLatency=c.maxLatencyMillis;f.animatedLatency=c.animatedLatencyMillis;
f.useDscp=c.dscpEnabled;f.useTdls=c.useTdls;null!==b&&(f.receiverVersion=b);null!==a&&(f.receiverProductName=a);e.length&&(f.lka=e);return f},el=function(a,b,c,e,f){F(bl,"getRawEvents");var g=J(),k=function(b){F(bl,"Got receiver version: "+b);b=JSON.stringify(dl(c,b,e,f));chrome.cast.streaming.rtpStream.getRawEvents(a,b,function(a){g.resolve(a)})};"Chromecast"==c?Rf(b).then(k,g.reject):k(null);return g.promise},fl=function(a,b,c,e){F(bl,"getStats");var f=J(),g=function(b){F(bl,"Got receiver version: "+
b);var g=dl(c,b,e,[]);chrome.cast.streaming.rtpStream.getStats(a,function(a){var b={tags:g};Eb(b,a);f.resolve(b)})};"Chromecast"==c?Rf(b).then(g,f.reject):g(null);return f.promise};al.prototype.Oa=function(){return"mirror.cast.LogUtils"};al.prototype.getData=function(){return[null,{lastAutoSubmitMillis:this.dm}]};al.prototype.rb=function(){var a=Te(this);this.dm=a&&a.lastAutoSubmitMillis||0};var gl=function(a,b){Fh.call(this,a,b)};u(gl,Fh);var hl=function(a){return a&&a.getAudioTracks()&&0<a.getAudioTracks().length?a.getAudioTracks()[0]:null},il=function(a){return a&&a.getVideoTracks()&&0<a.getVideoTracks().length?a.getVideoTracks()[0]:null};var jl=A("mr.NetworkUtils"),kl=function(a,b){if(!zh)return I("TDLS feature not enabled.");var c=J();chrome.networkingPrivate.setWifiTDLSEnabledState(a,b,function(a){chrome.runtime.lastError?(jl.ea("Unable to set TDLS state: state = "+b+", error = "+chrome.runtime.lastError.message),c.reject("Unable to set TDLS state to "+b+".")):(jl.info("TDLS state changed: state = "+b+", status = "+a),c.resolve(a))});return c.promise};var ll=function(a,b){this.sessionId=a;this.seqNum=b;this.type="PRESENTATION"};var ml=function(a,b,c){this.type="GET_STATUS";this.sessionId=a;this.seqNum=b;this.get_status=c};var nl=function(a,b){this.address=a;this.port=b},ol=function(a,b){Xg.call(this,b);this.a=A("mr.mirror.cast.Session");this.Zj=a;this.Ba=a.Hf().clone();this.Dd=Fg.Gu(b.id);this.G=b.$d.sessionId;this.cd=new nl(b.$d.NJ,2344);this.Wq=b.$d.OJ;this.jc=null;this.Cg=!1;this.Kb=null;this.yi=!1;this.ug=0;this.wa=this.Mn=this.Nn=null;this.V0=["H264","VP8"];this.Iv=new z;this.fA=null;this.bI=r(this.y_,this);this.aI=r(this.x_,this);this.Ll=null;this.Gm=new Ih(30);this.wH=!1;this.Ik=null;this.Wx=new zi("mirror.cast.SeqNumGenerator");
this.uc=this.Zd=null};u(ol,Xg);d=ol.prototype;
d.start=function(a){var b=hl(a);a=il(a);this.Zd=new Hg("MediaRouter.CastStreaming.Session.Launch");this.wa=J();this.iX();this.Ba.useTdls&&kl(this.cd.address,!0).then(function(a){"Connected"!=a&&(this.Ba.useTdls=!1)},function(){this.Ba.useTdls=!1},this);chrome.cast.streaming.session.create(b,a,r(function(a,b,f){this.jc=a;this.Kb=b;this.ug=f;this.Dd.onMessage=r(this.Dq,this);this.Vx({type:"OFFER",sessionId:this.getId(),seqNum:this.Wx.vp(),offer:this.il()})},this));return this.wa.promise};
d.stop=function(){this.uc&&(this.uc.end(),this.uc=null);F(this.a,"Stopping "+this.getId());null!==this.jc&&(chrome.cast.streaming.rtpStream.stop(this.jc),chrome.cast.streaming.rtpStream.destroy(this.jc),this.jc=null,this.Cg=!1);null!==this.Kb&&(chrome.cast.streaming.rtpStream.stop(this.Kb),chrome.cast.streaming.rtpStream.destroy(this.Kb),this.Kb=null,this.yi=!1);this.ug&&(chrome.cast.streaming.udpTransport.destroy(this.ug),this.ug=0);this.Ba.useTdls&&kl(this.cd.address,!1);this.wa&&(this.wa.resolve(this),
this.wa=null);chrome.cast.streaming.rtpStream.onStarted.removeListener(this.bI);chrome.cast.streaming.rtpStream.onError.removeListener(this.aI);null!==this.Ll&&(window.clearTimeout(this.Ll),this.Ll=null);this.Nn=this.Mn=null;if(this.Ik&&this.Ik.onSessionStop)this.Ik.onSessionStop(this.cd);return!0};d.Y4=function(a){this.Cg&&chrome.cast.streaming.rtpStream.toggleLogging(this.jc,a);this.yi&&chrome.cast.streaming.rtpStream.toggleLogging(this.Kb,a)};
d.getLogs=function(){if(!this.Cg&&!this.yi)return I(Error("No streams has been started yet."));var a=[];if(this.Cg){var b=el(this.jc,this.cd.address,this.Wq,this.Ba,this.Gm.v());a.push(b)}this.yi&&(b=el(this.Kb,this.cd.address,this.Wq,this.Ba,this.Gm.v()),a.push(b));return Ud(a).then(function(a){a=new Blob(a,{type:"application/gzip"});F(this.a,"Events blob size: "+a.size);return a},null,this)};
d.getStats=function(){var a=[];if(this.Cg){var b=fl(this.jc,this.cd.address,this.Wq,this.Ba);a.push(b)}this.yi&&(b=fl(this.Kb,this.cd.address,this.Wq,this.Ba),a.push(b));this.Gm.M()&&a.push(H({receiverStatusData:this.Gm.v()}));return Ud(a).then(function(a){var b={};v(a,function(a){Eb(b,a)});return b})};
d.XO=function(){var a=chrome.cast.streaming.rtpStream.getSupportedParams(this.jc)[0];a.payload.maxLatency=this.Ba.maxLatencyMillis;"minLatency"in a.payload&&(a.payload.minLatency=this.Ba.minLatencyMillis);"animatedLatency"in a.payload&&(a.payload.animatedLatency=this.Ba.animatedLatencyMillis);a.payload.ssrc=Math.floor(499999*Math.random())+1;a.payload.feedbackSsrc=2;a.payload.payloadType=127;a.payload.aesKey=this.Nn;a.payload.aesIvMask=this.Mn;return a};
d.kP=function(){var a=[];if(null===this.Kb)return a;var b=chrome.cast.streaming.rtpStream.getSupportedParams(this.Kb);this.V0.forEach(function(c){var e=Xa(b,function(a){return a.payload.codecName.toLowerCase()==c.toLowerCase()},this);e&&(e.payload.maxFrameRate=this.Ba.maxFrameRate,e.payload.minBitrate=this.Ba.minVideoBitrate,e.payload.maxBitrate=this.Ba.maxVideoBitrate,e.payload.maxLatency=this.Ba.maxLatencyMillis,"minLatency"in e.payload&&(e.payload.minLatency=this.Ba.minLatencyMillis),"animatedLatency"in
e.payload&&(e.payload.animatedLatency=this.Ba.animatedLatencyMillis),e.payload.aesKey=this.Nn,e.payload.aesIvMask=this.Mn,e.payload.ssrc=Math.floor(499999*Math.random())+500001,e.payload.feedbackSsrc=12,e.payload.payloadType=96,a.push(e))},this);return a};
d.il=function(){var a=0,b=[];if(this.jc){var c=this.XO();this.fA=c;c={index:a,type:"audio_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ba.maxLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,bitRate:128E3,sampleRate:c.payload.clockRate,timeBase:"1/"+c.payload.clockRate,channels:c.payload.channels,rtpExtensions:["adaptive_playout_delay"]};this.Ba.enableLogging&&Eb(c,{receiverRtcpEventLog:!0});
this.Ba.dscpEnabled&&Eb(c,{receiverRtcpDscp:46});b.push(c);a++}this.kP().forEach(function(c){var f={index:a,type:"video_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ba.maxLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,maxFrameRate:Math.round(1E3*c.payload.maxFrameRate)+"/1000",timeBase:"1/90000",maxBitRate:c.payload.maxBitrate,resolutions:[{width:this.Ba.maxWidth,height:this.Ba.maxHeight}],
rtpExtensions:["adaptive_playout_delay"]};this.Ba.enableLogging&&Eb(f,{receiverRtcpEventLog:!0});this.Ba.dscpEnabled&&Eb(f,{receiverRtcpDscp:46});b.push(f);this.Iv.set(a,c);a++},this);return{supportedStreams:b}};d.y_=function(a){a==this.jc?this.Cg=!0:a==this.Kb&&(this.yi=!0);this.Cg&&(null===this.Kb||this.yi)&&(this.Y4(this.Ba.enableLogging),this.wa&&(this.wa.resolve(this),this.wa=null));this.uc=new Jg("MediaRouter.CastStreaming.Session.Length")};
d.x_=function(a,b){if(a==this.jc)E(this.a,"Audio stream error "+b);else if(a==this.Kb)E(this.a,"Video stream error "+b);else{E(this.a,"Error for stream "+a+": "+b);return}this.wa&&(this.wa.reject(Error("Error for stream "+a+": "+b)),this.wa=null);this.stop()};
d.s7=function(a,b){G(this.a,"Starting streaming ... "+JSON.stringify({udpTransportId:this.ug,receiverIpEndPoint:this.cd,"audio ID":this.jc,"video ID":this.Kb,"audio params":a,"video params":b}));if(ia(chrome.cast.streaming.udpTransport.B5)){var c={};this.Ba.dscpEnabled&&(F(this.a,"Enable DSCP in sender."),c.DSCP=!0);chrome.cast.streaming.udpTransport.B5(this.ug,c)}chrome.cast.streaming.udpTransport.setDestination(this.ug,{address:this.cd.address,port:this.cd.port});chrome.cast.streaming.rtpStream.onStarted.addListener(this.bI);
chrome.cast.streaming.rtpStream.onError.addListener(this.aI);a&&chrome.cast.streaming.rtpStream.start(this.jc,a);b&&chrome.cast.streaming.rtpStream.start(this.Kb,b)};
d.Dq=function(a){if("urn:x-cast:com.google.cast.webrtc"==a.namespace_){a=a.data;G(this.a,a);var b=JSON.parse(a);if("ANSWER"==b.type&&"ok"==b.result){b.answer.udpPort&&(this.cd.port=b.answer.udpPort);this.wH=!!b.answer.receiverGetStatus;if(this.Ik&&this.Ik.onAnswer)this.Ik.onAnswer(this.cd);this.Zd&&(this.Zd.end(),this.Zd=null);F(this.a,"Starting streaming");var c=this.fA,e=null;b.answer.sendIndexes&&b.answer.sendIndexes.forEach(function(a){c&&0==a?b.answer.ssrcs&&b.answer.ssrcs[a]&&(c.payload.feedbackSsrc=
b.answer.ssrcs[a]):this.Iv.Ja(a)&&(e?E(this.a,"Receiver selected multiple video stream"):(e=this.Iv.get(a),b.answer.ssrcs&&b.answer.ssrcs[a]&&(e.payload.feedbackSsrc=b.answer.ssrcs[a])))},this);null!==this.Kb&&null===e&&(E(this.a,"Receiver is capable of video, but did not specify a video stream index in the ANSWER message."),chrome.cast.streaming.rtpStream.destroy(this.Kb),this.Kb=null);if(c||e){this.ED();this.s7(c,e);this.wa&&(this.wa.resolve(this),this.wa=null);return}}if("STATUS_RESPONSE"!=b.type||
null===b.status)this.wa&&(this.wa.reject(Error("Invalid answer: "+b)),this.wa=null),this.stop();else{a={};for(var f in b.status){var g=b.status[f];ga(g)&&g.length?a[f]=g.pop():a[f]=g}f={};f[(new Date).toISOString()]=a;this.Gm.add(f)}}};d.iX=function(){this.Mn=kf(window.crypto.getRandomValues(new Uint8Array(16)));this.Nn=kf(window.crypto.getRandomValues(new Uint8Array(16)))};d.mI=function(){this.Vx(this.AU())};d.Vx=function(a){this.Dd.sendMessage(a,{namespace:"urn:x-cast:com.google.cast.webrtc"})};
d.ED=function(){this.Ll=null;if(this.ug&&this.wH){var a=new ml(this.getId(),this.Wx.vp(),["wifiSnr","wifiSpeed","wifiFcsError"]);this.Vx(a);this.Ll=window.setTimeout(r(this.ED,this),12E4)}};d.AU=function(){var a=new ll(this.G,this.Wx.vp());a.title=this.Ax||void 0;a.icons=this.iconUrl&&!this.$p?[new chrome.cast.Image(this.iconUrl)]:[];return a};d.getId=function(){return this.G};d.sj=function(){return this.Zj};d.K=function(){this.Dd.hb();this.stop()};var pl=function(a){Wg.call(this,"cast_streaming",a)};u(pl,Wg);d=pl.prototype;d.getName=function(){return"cast_streaming"};d.sj=function(a,b){return new gl(a,b)};d.zt=function(a,b){if(a instanceof gl)return new ol(a,b);throw Error("Invalid parameters");};d.sx=function(){Xk(0)};d.ox=function(){Xk(1)};d.px=function(){Lg("MediaRouter.CastStreaming.Session.End")};d.qx=function(a){Mg("MediaRouter.CastStreaming.Start.Failure",a,Ng)};d.rx=function(){Lg("MediaRouter.CastStreaming.Stream.End")};
d.kA=function(){var a=this.Ma,b=a.getLogs().then(function(a){return a},function(a){E(this.m,"Get cast streaming logs failed.",a)},this),a=a.getStats().then(function(a){return a},function(a){E(this.m,"Get cast streaming stats failed.",a)},this),c=J();chrome.metricsPrivate.getIsCrashReportingEnabled(function(a){c.resolve(a)});return Ud([b,a,c.promise]).then(function(a){var b=a[0],c=new FileReader;c.onloadend=function(){bf("mr.temp.mirror.cast.Service.mirrorLogs",c.result)};c.readAsBinaryString(b);var k=
a[1];a[2]&&(b&&al.O().V6()?$k(b,void 0,this.kZ.bind(this)):k&&Zk("stats.json",new Blob([JSON.stringify(k)],{type:"application/json"}),void 0,void 0))},null,this)};d.kZ=function(a){a&&(al.O().dm=t())};d.UT=function(a){F(this.m,"Received message to upload logs for "+a);return this.Ma?this.Ma.getLogs().then(function(b){return $k(b,a)},function(b){E(this.m,"Get cast streaming logs failed.",b);return this.VF(a)},this):H(this.VF(a))};
d.VF=function(a){var b=window.localStorage["mr.temp.mirror.cast.Service.mirrorLogs"];if(!b)return"";window.localStorage.removeItem("mr.temp.mirror.cast.Service.mirrorLogs");F(this.m,"Uploading saved logs for feedback.");for(var c=new Uint8Array(b.length),e=0;e<c.length;e++)c[e]=b.charCodeAt(e);return $k(new Blob([c],{type:"application/gzip"}),a)};var ql={Bz:0,pz:1},rl=function(a){Mg("MediaRouter.WebRtc.Start.Success",a,ql)};var tl=function(a,b){ae.call(this);this.a=vd("cv2.PeerConnection");this.CY=sl;this.o=this.dP(b);this.rP=this.ZO(a);this.ZP=!0;this.Xx=J();this.ic=!1;this.rG=this.sG=this.Hw=this.zG=this.rZ=ca};u(tl,ae);var sl={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},ul={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};d=tl.prototype;d.v5=function(a){this.Hw=a};d.u5=function(a){this.sG=a};d.t5=function(a){this.rG=a};d.x5=function(a){this.zG=a};
d.w5=function(a){this.rP.onmessage=function(b){a(b.data)}};d.Wv=function(){return this.ic};d.pU=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);return b};d.dP=function(a){a=this.pU(a);var b=new webkitRTCPeerConnection(a);b.onicecandidate=r(this.Jw,this);b.ija=r(this.HZ,this);b.oniceconnectionstatechange=r(this.GZ,this);F(this.a,"Created webkitRTCPeerConnnection with config: "+JSON.stringify(a));return b};d.ZO=function(a){return this.o.createDataChannel(a,{reliable:!1})};
d.start=function(){this.ic||(this.ic=!0,this.il())};d.stop=function(){F(this.a,"Stopping peer connection...");this.ic&&(this.ic=!1,"closed"!=this.o.signalingState&&this.o.close())};d.addStream=function(a){this.o.addStream(a)};d.removeStream=function(a){this.ic&&this.o.removeStream(a)};d.K=function(){this.stop();this.o=null};d.il=function(){F(this.a,"Sending offer to peer.");var a=this;this.o.createOffer(r(this.ZI,this),function(b){E(a.a,"Error creating offer: "+JSON.stringify(b))},this.CY);this.lV().then(function(b){a.zG(b)})};
d.ZI=function(a){F(this.a,"Setting local description: "+JSON.stringify(a));var b=this;this.o.setLocalDescription(a,function(){F(b.a,"Local description set successfully")},function(a){E(b.a,"Error setting local description: "+JSON.stringify(a))})};d.VB=function(a){return{type:a.type,sdp:a.sdp}};d.lV=function(){return this.Xx.promise};
d.setRemoteDescription=function(a){G(this.a,"<===: "+JSON.stringify(a));a=new RTCSessionDescription(a);F(this.a,"Setting remote description: "+JSON.stringify(a));var b=this;this.o.setRemoteDescription(a,function(){F(b.a,"Remote description set successfully.")},function(a){E(b.a,"Error setting remote description: "+JSON.stringify(a))})};d.Jw=function(a){a.candidate||(F(this.a,"End of candidates."),this.Xx.resolve(this.VB(this.o.localDescription)))};
d.HZ=function(){"completed"==this.o.iceGatheringState&&this.Xx.resolve(this.VB(this.o.localDescription))};
d.GZ=function(a){if(this.o){var b=this.o.iceConnectionState;F(this.a,"New ICE connection state: "+b+".");if("connected"==b)this.Hw("iceconnected");else if("completed"==b)this.Hw("icecompleted");else if("failed"==b)E(this.a,"Ice connection failed: "+JSON.stringify(a)),this.sG("icefailed");else if("closed"==b)this.rG("iceclosed");else if("disconnected"==b)if(E(this.a,"Ice connection state is bad."),this.ZP&&this.Wv()){F(this.a,"Restarting ICE.");var c=this;this.o.createOffer(r(this.ZI,this),function(a){E(c.a,
"Error creating new offer: "+JSON.stringify(a))},ul)}else this.rZ()}};var vl=function(a,b){Xg.call(this,b);this.Zj=a;this.cH=J();this.o=this.cH.promise;this.Dd=Fg.Gu(b.id);this.wa=J();this.Qv=this.ic=!1;this.uc=this.Zd=null;this.vy();this.G6();this.Gc(new Yg("GET_TURN_CREDENTIALS"))};u(vl,Xg);d=vl.prototype;d.start=function(a){var b=this;return this.o.then(function(c){if(c.Wv())return I(Error("Mirroring already started"));b.Zd=new Hg("MediaRouter.WebRtc.Session.Launch");c.addStream(a);c.start();return b.wa.promise})};
d.stop=function(){this.uc&&this.uc.end();this.Qv=this.ic=!1;this.Zd=this.uc=null;this.o.then(function(a){a.stop()});return!0};d.K=function(){this.Dd.hb();this.stop()};
d.vy=function(){var a=this;this.Dd.onMessage=function(b){if(!b.type)throw Error("Message has no type.");switch(b.type){case "TURN_CREDENTIALS":a.cH.resolve(new tl(a.Ca.id,b.data.credentials));break;case "ANSWER":a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "KNOCK_ANSWER":a.Qv=!0;a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.wa.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}}};
d.G6=function(){var a=this;this.o.then(function(b){b.x5(function(b){b=new $g(a.Zj.Hf(),sl,b);a.Gc(new Yg("OFFER",b))});b.w5(function(b){a.Gc(Zg(b))});b.v5(function(){a.ic=!0;a.Gc(new Yg("SESSION_START_SUCCESS"));!a.Qv&&a.Zd&&a.Zd.end();a.Zd=null;a.uc=new Jg("MediaRouter.WebRtc.Session.Length");a.wa.resolve(a)});b.t5(function(){a.Gc(new Yg("SESSION_END"))});b.u5(function(b){a.ic||a.wa.reject(b);a.Gc(new Yg("SESSION_FAILURE"))})})};var wl={channelType:"cloud"};
vl.prototype.Gc=function(a){this.Dd.sendMessage(a,wl)};vl.prototype.sj=function(){return this.Zj};var xl=function(a){Wg.call(this,"webrtc",a)};u(xl,Wg);d=xl.prototype;d.sj=function(a,b){return new Fh(a,b)};d.zt=function(a,b){if(a instanceof Fh)return new vl(a,b);throw Error("Invalid parameters");};d.sx=function(){rl(0)};d.ox=function(){rl(1)};d.px=function(){Lg("MediaRouter.WebRtc.Session.End")};d.qx=function(a){Mg("MediaRouter.WebRtc.Start.Failure",a,Ng)};d.rx=function(){Lg("MediaRouter.WebRtc.Stream.End")};var yl=function(a,b,c){ae.call(this);this.eY=null!=c?r(a,c):a;this.Uf=b;this.Zk=r(this.I_,this);this.Ps=[]};u(yl,ae);d=yl.prototype;d.zk=!1;d.Am=0;d.xb=null;d.du=function(a){this.Ps=arguments;this.xb||this.Am?this.zk=!0:this.Kt()};d.stop=function(){this.xb&&(Ke(this.xb),this.xb=null,this.zk=!1,this.Ps=[])};d.pause=function(){this.Am++};d.resume=function(){this.Am--;this.Am||!this.zk||this.xb||(this.zk=!1,this.Kt())};d.K=function(){yl.R.K.call(this);this.stop()};
d.I_=function(){this.xb=null;this.zk&&!this.Am&&(this.zk=!1,this.Kt())};d.Kt=function(){this.xb=Je(this.Zk,this.Uf);this.eY.apply(null,this.Ps)};var Al=function(a){this.Ka={};if(a)for(var b=0;b<a.length;b++)this.Ka[zl(a[b])]=null;for(var c in Object.prototype)Na(c+" should not be enumerable in Object.prototype.")},Bl={},zl=function(a){return a in Bl||32==String(a).charCodeAt(0)?" "+a:a},Cl=function(a){return 32==a.charCodeAt(0)?a.substr(1):a};d=Al.prototype;d.add=function(a){this.Ka[zl(a)]=null};d.Gz=function(a){for(var b=0;b<a.length;b++)this.Ka[zl(a[b])]=null};d.RM=function(a){for(var b in a.Ka)this.Ka[b]=null};
d.clear=function(){this.Ka={}};d.clone=function(){var a=new Al;a.RM(this);return a};d.contains=function(a){return zl(a)in this.Ka};d.equals=function(a){return this.fq(a)&&a.fq(this)};d.forEach=function(a,b){for(var c in this.Ka)a.call(b,Cl(c),void 0,this)};d.M=Object.keys?function(){return Object.keys(this.Ka).length}:function(){var a=0,b;for(b in this.Ka)a++;return a};d.v=Object.keys?function(){return Object.keys(this.Ka).map(Cl,this)}:function(){var a=[],b;for(b in this.Ka)a.push(Cl(b));return a};
d.Qa=function(){for(var a in this.Ka)return!1;return!0};d.fq=function(a){for(var b in this.Ka)if(!(b in a.Ka))return!1;return!0};d.remove=function(a){a=zl(a);return a in this.Ka?(delete this.Ka[a],!0):!1};d.kd=function(){return lc(this.v())};var Dl=function(){this.pc=null;this.a=A("mr.IssueSenderImpl")};Dl.prototype.init=function(a){this.pc=a};Dl.prototype.send=function(a){if(this.pc)if(this.pc.onIssue)this.pc.onIssue(a);else B(this.a,"MediaRouterService.onIssue not defined.");else B(this.a,"MediaRouterService is not set.")};var El=new yc;var Fl=function(a,b){K.call(this,"internal_message");this.routeId=a;this.message=b};u(Fl,K);var Gl=function(a,b,c){ae.call(this);this.YH=a;this.de=b;this.JY=c;this.onMessage=ca;c.listen("internal_message",this.Dq,!1,this)};u(Gl,ae);Gl.prototype.sendMessage=function(a,b){return this.de(this.YH,a,b)};Gl.prototype.Dq=function(a){if(a.routeId==this.YH)this.onMessage(a.message)};Gl.prototype.K=function(){this.JY.Mc("internal_message",this.Dq,!1,this)};var Hl=new Gl("",function(){return H()},new L),Il=function(a){this.B=a};
Il.prototype.Gu=function(a){var b=this.B.Zu(a);return b?new Gl(a,r(b.lg,b),this.B.fv()):Hl};var Jl=function(){this.a=A("mr.ProviderManager");this.Ec=[];this.Fc=new z;this.Pm=new z;this.ge=new Al;this.ci=new Al;this.Tj=new z;this.pc=null;this.Ak=!1;this.ZH=new L;this.$H=new yl(this.o3,500,this);this.e7=new yl(this.nQ,500,this);this.sm=new Vk;this.bx=0;this.cF=new Dl;this.Bk=new z;this.xq=-1==window.navigator.userAgent.indexOf("Windows");this.wq=[];this.createRoute=this.uf;this.joinRoute=this.xh;this.connectRouteByRouteId=this.Lg;this.closeRoute=this.terminateRoute=this.vc;this.startObservingMediaSinks=
this.ri;this.stopObservingMediaSinks=this.ti;this.sendRouteMessage=this.lg;this.sendRouteBinaryMessage=this.n3;this.listenForRouteMessages=this.rw;this.stopListeningForRouteMessages=this.Jy;this.startObservingMediaRoutes=this.pi;this.stopObservingMediaRoutes=this.si;this.onPresentationSessionDetached=this.detachRoute=this.yf;this.enableMdnsDiscovery=this.uB;this.updateMediaSinks=this.q8};Jl.prototype.TT=function(a){return this.Tj.get(a).nm().then(function(a){return a})};
Jl.prototype.N1=function(a){a.forEach(this.Q1,this)};Jl.prototype.Wc=function(a,b){this.Tj.set("webrtc",new ah(new xl(this)));this.Tj.set("cast_streaming",new ah(new pl(this)));var c=wh.O();c.f5(this);this.Tj.set("hangouts",c);c=new Il(this);Fg||(Fg=c);this.pc=a;this.cF.init(a);this.N1(b);Ve(this)};
Jl.prototype.Q1=function(a){if(this.AD(a.getName()))E(this.a,"Provider "+a.getName()+" already registered.");else try{a.Wc(),this.Ec.push(a),this.Bk.set(a.getName(),0)}catch(b){E(this.a,"Provider "+a.getName()+" failed to initialize.",b)}};var Kl=function(a,b){return new Promise(function(c,e){var f=b?Je(function(){f=null;e(new Sk(1,"timeout after "+b+" ms."))},b):null;a.then(function(a){c(a)},function(a){e(a instanceof Sk?a:new Sk(0,a.message,a.stack))}).Va(function(){Ke(f)})})};d=Jl.prototype;
d.fx=function(){this.bx++;this.om()};d.Ks=function(){this.bx--;this.om()};d.uf=function(a,b,c,e,f,g,k){var l=this.EU(a,b);if(!l)return Promise.reject(new Sk(2,"No provider supports createRoute with source: "+a+" and sink: "+b));this.fx();El.add(b);this.qc();g=g&&0<g?g:6E4;a=l.uf(a,b,c,k||!1,g,e,f).then(function(a){this.Lh(l,a);return H(a)},function(a){B(this.a,"Error creating route.",a);throw a;},this).Va(function(){El.remove(b);this.qc();this.Ks()},this);return Kl(a,g)};
d.Lg=function(a,b,c,e,f,g){var k=this.Fc.get(b);if(!k)return Promise.reject(new Sk(2,"No provider supports join "+b));this.fx();a=k.Lg(a,b,c,e,f).Va(function(){this.Ks()},this);return Kl(a,g&&0<g?g:3E4)};d.xh=function(a,b,c,e,f,g){var k=this.DU(a);if(!k)return Promise.reject(new Sk(2,"No provider supports join "+b));this.fx();f=f&&0<f?f:3E4;a=k.xh(a,b,g||!1,f,c,e).Va(function(){this.Ks()},this);return Kl(a,f)};
d.vc=function(a){var b=this.Fc.get(a);b?this.UF(a).Va(function(){b.vc(a)}):E(this.a,"Route "+a+" does not exist.")};d.ri=function(a){this.ge.contains(a)||(this.ge.add(a),this.Ec.forEach(function(b){b.ri(a)}));this.Rq(a)};d.ti=function(a){this.ge.remove(a)?this.qB(a):F(this.a,"No existing query "+a)};d.qB=function(a){this.Ec.forEach(function(b){b.ti(a)})};
d.Rq=function(a){if("urn:x-org.chromium.media:source:tab:-1"==a)E(this.a,"No sinks for sourceUrn: "+a);else{var b=new z,c=[];this.Ec.forEach(function(e){var f=e.wl(a);0<f.sinks.length&&(c=f.origins);f.sinks.forEach(function(a){b.Ja(a.id)?E(this.a,"Detected duplicate sink "+a.id+" from provider: "+e.getName()):b.set(a.id,a)},this)},this);this.p3(a,b.v(),c||[])}};d.p3=function(a,b,c){F(this.a,"Sending "+b.length+" sinks to MR for "+a);Ll(b);this.pc.onSinksReceived(a,b,c)};
var Ll=function(a){a.forEach(function(a){a.isLaunching_=El.contains(a.id)})};d=Jl.prototype;d.lg=function(a,b,c){var e=this.Fc.get(a);return e?Kl(e.lg(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.n3=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.rw=function(a){return this.Fc.Ja(a)?Kl(this.sm.rw(a)):Promise.reject(Error("Invalid route ID"))};d.Jy=function(a){this.sm.Jy(a)};
d.yf=function(a){var b=this.Fc.get(a);b?b.yf(a):F(this.a,"Route "+a+" does not exist.")};d.uB=function(){this.xq=!0;this.wq.forEach(function(a){a()});this.wq.length=0;var a=this;this.ge.forEach(function(b){a.Rq(b)})};d.EU=function(a,b){return this.Ec.find(function(c){return c.$k(a,b)})||null};d.DU=function(a){return this.Ec.find(function(b){return b.Ki(a)})||null};d.nQ=function(){this.ge.forEach(function(a){this.Rq(a)},this)};d.om=function(){this.pc.setKeepAlive(this.YW()||0<this.bx)};
d.pi=function(a){this.ci.contains(a)||(this.Ak=!0,this.ci.add(a),this.Ec.forEach(function(b){b.pi(a)}));this.$H.du();this.om()};d.si=function(a){this.ci.remove(a)?(0==this.ci.length&&(this.Ak=!1),this.Ec.forEach(function(b){b.si(a)}),this.om()):F(this.a,"No existing route query "+a)};
d.o3=function(){if(this.Ak){var a=[];this.Ec.forEach(function(b){a=a.concat(b.Fe())});this.ci.forEach(function(b){var c=[];this.Ec.forEach(function(a){a.Fe().forEach(function(f){!f.Ui&&a.Ki(b,f)&&c.push(f.id)})});this.pc.onRoutesUpdated(a,b,c)},this)}};var Ml=function(a,b,c,e,f,g,k){this.d7=b;this.S2=c;this.Y6=e;this.XH=f;this.c7=g;this.BY=k};d=Jl.prototype;d.Oa=function(){return"ProviderManager"};
d.getData=function(){var a={};this.Fc.forEach(function(b,c){a[c]=b.getName()});return[new Ml(this.Ec.map(function(a){return a.getName()}),this.ge.v(),this.ci.v(),this.Ak,a,this.Bk.b(),this.xq)]};d.rb=function(){var a=Se(this);if(a){this.ge.Gz(a.d7);this.ci.Gz(a.S2);this.Ak=a.Y6;for(var b in a.XH){var c=this.AD(a.XH[b]);this.Fc.set(b,c)}this.Bk.addAll(a.c7);a.BY&&this.uB()}};d.Zu=function(a){return this.Fc.get(a)};d.Lh=function(a,b){this.Fc.set(b.id,a);this.bg(a,b)};
d.ag=function(a,b){this.UF(b.id);var c=this,e=function(){c.Fc.remove(b.id);c.sm.ag(b.id);c.bg(a,b)};this.sm.yE(b.id)?Je(e,50,this):e()};d.bg=function(){this.om();this.Ak&&this.$H.du()};d.yG=function(a){var b=this.Fc.get(a.id);b&&this.bg(b,a)};d.Gd=function(a,b,c){this.Fc.Ja(b)?this.sm.send(b,JSON.stringify(c)):E(this.a,"Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){this.pc.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){if("function"!=typeof this.pc.onPresentationConnectionClosed)this.onPresentationConnectionStateChanged(a,"closed");else this.pc.onPresentationConnectionClosed(a,b,c)};d.Lw=function(a){this.Pm.remove(a);var b=this.Fc.get(a);b&&b.vc(a)};d.Cq=function(a,b,c){this.ZH.dispatchEvent(new Fl(b,c))};d.qc=function(){this.e7.du()};
d.onSinkAvailabilityUpdated=function(a,b){if("function"==typeof this.pc.onSinkAvailabilityUpdated&&this.Bk.get(a.getName())!=b){var c=this.TA();this.Bk.set(a.getName(),b);var e=this.TA();c!=e&&(this.pc.onSinkAvailabilityUpdated(e),0==e&&(this.ge.forEach(function(a){this.qB(a)},this),this.ge.clear()))}};d.TA=function(){return this.Bk.v().reduce(function(a,b){return Math.max(a,b)},0)};d.fv=function(){return this.ZH};d.Gf=function(){return this.cF};d.YW=function(){return this.Ec.some(function(a){return a.Fe().some(function(a){return a.isLocal})})};
d.UF=function(a){if(this.Pm.Ja(a)){var b=this;return this.Tj.get(this.Pm.get(a)).nm().then(function(c){b.Pm.remove(a);return c.$J()})}return H(!1)};d.kn=function(a,b,c){var e=a.Gl(b.sinkId);this.Pm.set(b.id,e);return this.Tj.get(e).nm().then(function(e){return e.kn(b,b.mediaSource,a.Hf(b.sinkId),c)})};d.ux=function(a){this.xq?a():-1==this.wq.indexOf(a)&&this.wq.push(a)};d.Sv=function(){return this.xq};d.AD=function(a){return this.Ec.find(function(b){return b.getName()==a})||null};
d.q8=function(a){this.ge.contains(a)||this.Rq(a)};var Nl={b9:0,DENIED:1,TIMEOUT:2},Ol={xz:0,q$:1},Pl={vM:0,ZL:1,ica:2,H$:3,G$:4,oaa:5},Ql={E$:0,Hba:1},Rl={Qaa:0,iaa:1,Yba:2,z$:3},Sl=function(a){Mg("MediaRouter.Cloud.Knock.Result",a,Nl)},Tl=function(a){Mg("MediaRouter.Cloud.Session.Start",a,Ol)},Ul=function(a){Mg("MediaRouter.Cloud.Session.Type",a,Ql)},Vl=function(a){Mg("MediaRouter.Cloud.Device.UserRole",a,Rl)};var Wl=function(a,b,c,e,f,g){this.eF=a;this.ed=b;this.cj=e||null;this.yq=c||null;this.Ld=f||null;this.$h=g||null};d=Wl.prototype;d.$g=function(){var a="";this.Ld?a=this.Ld:this.yq&&(a=this.yq);return a};d.getId=function(){return this.eF+"@"+this.ed};d.getService=function(){return this.ed};d.Ou=function(){return this.yq};d.Df=function(){return this.cj};d.WU=function(){return this.$h};
d.merge=function(a){!this.$h&&a.$h&&(this.$h=a.$h);!this.Ld&&a.Ld&&(this.Ld=a.Ld);this.Ld&&a.Ld&&this.$h&&(this.Ld=a.Ld)};var Xl=function(a,b){this.Ag=a;this.f8=b},Yl=new Xl("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Zl=new Xl("https://www.googleapis.com/calendar/v3",""),$l=new Xl("https://www.googleapis.com/hangouts/v1",""),am=new Xl("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var bm=function(a,b){this.pb=a;this.Eb=b;this.a=A("mr.cloud.calendar.CalendarService")};d=bm.prototype;d.HQ=function(){var a=this;return this.KR(this.Eb.gE(),9E5).then(function(b){F(a.a,a.cC(b.length)+" events discovered before filtering.");return a.TS(b)},function(b){E(a.a,"Error getting Hangouts from calendar: "+b);return[]})};d.cC=function(a){return 20<a?"20+":a.toString()};d.KR=function(a,b){var c=t(),e=this;return this.lR(a,new Date(c),new Date(c+b)).then(function(a){return a.filter(e.FX)})};
d.FX=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.lR=function(a,b,c){a=this.pb.ej(Zl.Ag,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});G(this.a,"Retrieving Hangouts from Calendar: "+a);return this.pb.Dg(a,"GET").then(function(a){return a.items?a.items:[]})};
d.TS=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var f=new Xi(e.hangoutLink),g=b.l0(f.Wd());if(2==g.length){var f=g[0],g=g[1],k,l;-1!=f.indexOf(".")&&(k=g,l=f);a.push(new Wl(g,f,k,l,e.summary))}else E(b.a,"Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);F(this.a,this.cC(a.length)+" events discovered with Hangout links.");return a};d.l0=function(a){return a.substring(12).split("/")};var cm=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},dm=function(a){this.type=a},em=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};u(em,dm);
var fm=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},gm={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},hm=new fm("_stopSession",{},"viewer"),im=new fm("_startWebrtcSession",gm),jm=new fm("_knockingStartWebrtcSession",gm,"viewer");var km=function(a){this.nb=a;this.id=a.id;this.a=A("mr.cloud.devices.CloudDevice")};d=km.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.BX(),b=this.vX(),c=this.FA(864E5);G(this.a,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}c=this.FA(9E5);F(this.a,"Availability for legacy receiver app: "+c);return c};d.FA=function(a){var b=this.iT();return!!(b&&b>t()-a)};d.vX=function(){return"available"==this.getState().appStatus};
d.BX=function(){return"online"==this.nb.connectionStatus};d.iT=function(){return this.nb.lastUpdateTimeMs?Number(this.nb.lastUpdateTimeMs):null};d.$g=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.nb.state._cloudCast};d.YE=function(){return this.nb.invitations?0!=this.nb.invitations.length:!1};d.QQ=function(){return this.nb.personalizedInfo.maxRole};var lm=function(a){this.pb=a};lm.prototype.getDevice=function(a){a=this.pb.ej(Yl.Ag,["devices",a]);return this.pb.Dg(a,"GET").then(function(a){return new km(a)})};lm.prototype.bY=function(){return this.wF({descriptionSubstring:"Chrome Streaming Receiver"})};
lm.prototype.wF=function(a){var b=this,c=this.pb.ej(Yl.Ag,["devices"],a);return this.pb.Dg(c,"GET").then(function(c){var f=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new km(a)});if(c=c.nextPageToken){var g=Bb(a);g.token=c;return b.wF(g).then(function(a){return f.concat(a)})}return f})};lm.prototype.aY=function(){return this.bY().then(function(a){return a.filter(function(a){return a.isAvailable()&&!a.YE()})})};var mm=function(a,b,c,e,f,g,k){var l=wf.O().Wo(a);this.Xc=new gi(l,b,g,k,f);this.deviceId=a;this.H7=c;this.ae=e};mm.prototype.cK=function(a){return Za(this.H7,a)};var nm=function(a,b,c,e){mm.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.zs=c};u(nm,mm);var om=function(a){var b=a.getService();a.Df()&&(b=a.Df());var c;a.Ou()&&a.$g()!=a.Ou()&&(c=a.Ou());mm.call(this,a.getId(),a.$g(),["mesi"],"Hangout",b,"hangout",c);this.QH=a.WU()||""};u(om,mm);var pm=function(a,b){this.x8=a;this.fe=b;this.$e=new z;this.Gr=new z;this.gm=null},qm=function(a,b,c){this.sinks=a;this.PA=b;this.hF=c};d=pm.prototype;d.oc=function(){this.aO()&&(this.gm=t(),this.sl());return this.$e.v()};d.Gs=function(a){this.$e.set(a.Xc.id,a)};d.Yq=function(a){return this.$e.remove(a)};d.ga=function(a){return this.$e.get(a,null)};d.aO=function(){var a=this.gm+2E4;return null==this.gm||a<t()};d.sl=function(){var a=this;return this.x8().then(function(b){return a.w8(b)})};
d.w8=function(a){var b=new z(this.$e),c=new z,e=new z,f=[],g=[];a.forEach(function(a){var l=a.Xc.id;c.set(l,a);e.set(l,a.deviceId);b.Ja(l)?b.Ja(l)&&JSON.stringify(b.get(l))!=JSON.stringify(a)&&g.push(a.Xc):f.push(a.Xc);b.remove(l)},this);a=b.Xa().map(function(a){return b.get(a).Xc});this.Gr.clear();this.Gr=e;this.$e.clear();this.$e=c;this.YN(f,g,a)};d.YN=function(a,b,c){0<a.length&&this.fe.C_(a);0<b.length&&this.fe.qc(b);0<c.length&&this.fe.cg(c)};
d.b=function(){return new qm(this.$e.b(),this.Gr.b(),this.gm)};d.AF=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.ae?(e=c.deviceId.split("@"),e=new om(new Wl(e[0],e[1],c.Xc.description,c.Xc.domain,c.Xc.friendlyName,c.QH))):"Chrome Streaming Receiver"==c.ae&&(e=new nm(c.deviceId,c.Xc.friendlyName,c.zs,c.Xc.domain));this.$e.set(b,e)}for(b in a.PA)this.Gr.set(b,a.PA[b]);a.hF&&(this.gm=a.hF)};var rm=function(a,b){this.GO=a;this.ko=new pm(this.sl.bind(this),b);Ve(this)};d=rm.prototype;d.oc=function(){return this.ko.oc()};d.ga=function(a){return this.ko.ga(a)};d.sl=function(){return this.GO.aY().then(function(a){return a.filter(function(a){return!a.YE()}).map(function(a){Lg("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");return new nm(a.getId(),a.$g(),a.QQ(),"default")})})};d.Oa=function(){return"CloudSinkDiscoveryService"};d.getData=function(){return[{cache:this.ko.b()}]};
d.rb=function(){var a=Se(this);a&&this.ko.AF(a.cache)};var sm=function(a,b,c){this.TN=a;this.IY=b;this.Op=new pm(this.sl.bind(this),c);this.rq=new z;Ve(this)};sm.prototype.Nz=function(a,b){var c=new Wl(a,b,a,b);this.rq.set(c.getId(),c);return c};sm.prototype.addManualHangout=sm.prototype.Nz;sm.prototype.HH=function(a,b){this.JF(new Wl(a,b,a,b))};sm.prototype.removeManualHangout=sm.prototype.HH;d=sm.prototype;d.oc=function(){return this.Op.oc()};d.ga=function(a){return this.Op.ga(a)};
d.sl=function(){F(this.a,"Fetching hangouts");var a=this;return Vd([this.IY.EQ(),this.TN.HQ()]).then(function(b){var c=x(a.rq.v());b.forEach(function(a){a.ZB?c=c.concat(a.value):B(this.a,"Error discovering Hangouts",a.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];Lg("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.JF(b)})})};d.JF=function(a){return new om(a)};d.Oa=function(){return"HangoutSinkDiscoveryService"};
d.getData=function(){return[{cache:this.Op.b(),manualHangouts:this.rq.b()}]};d.rb=function(){var a=Se(this);if(a){this.Op.AF(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.rq.set(b,new Wl(c.eF,c.ed,c.yq,c.cj,c.Ld,c.$h))}}};var tm=function(a){this.Eb=a};d=tm.prototype;d.ej=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new Xi(a+e);c&&(c=gj(c),a.ur(c));return a};d.Dg=function(a,b,c){var e=this;return e.Eb.getAuthToken().then(function(f){var g=e.bR(f);return e.UN(g,a,b,c).na(function(g){if("INVALID_ACCESS_ERROR"==g)return e.pQ(f,a,b,c);throw g;})})};d.pQ=function(a,b,c,e){var f=this;return this.Eb.oQ(a).then(function(){return f.Dg(b,c,e)})};
d.UN=function(a,b,c,e){var f=J(),g=this;a.sendRequest(this.KQ(b,c,function(a){a&&!a.error?f.resolve(a):g.CX(a)?f.reject("INVALID_ACCESS_ERROR"):f.reject(g.i0(a))},e));return f.promise};d.CX=function(a){return!!a&&401==a.error.code};d.bR=function(a){a=new Rh(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.i0=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.KQ=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var um=function(){this.Ze=!1;this.he=null;this.Gj=!1;this.a=A("mr.cloud.identity.IdentityService");Ve(this);this.cY();this.xJ()},vm="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");d=um.prototype;d.Pv=function(){return this.Gj};d.TE=function(){return"google.com"==this.hE()};
d.TX=function(){return this.Gj||this.Ze&&!!this.he&&(-1!=vm.indexOf(this.he)||-1!=vm.indexOf(this.hE()))};d.hE=function(){return this.he?this.he.substr(this.he.indexOf("@")+1):""};d.bF=function(){return this.Ze};d.gE=function(){return this.he};d.getAuthToken=function(){return this.oC(!0)};
d.oC=function(a){return chrome.identity?new Od(function(b,c){chrome.identity.getAuthToken({interactive:a},function(a){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==a?c(Error("User is not logged in (no token found)")):b(a)})}):I(Error("chrome.identity permission required for auth."))};d.oQ=function(a){return new Od(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.xJ=function(){var a=this;this.oC(!1).then(function(b){chrome.identity.getProfileUserInfo(function(c){a.Ze=!!c.email||!!c.id;a.he=c.email||null;b&&!a.Ze&&(a.Gj=!0)})},function(b){G(a.a,"Unable to set sign in and email.",b)})};d.cY=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){a.Ze=c;F(a.a,"Signed in change: "+a.Ze);a.Ze?a.xJ():(a.he=null,a.Gj=!1)})};
d.M1=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return B(a.a,"gapi not loaded."),!1;F(a.a,"Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.Oa=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.Ze,userEmail:this.he,kioskAuth:this.Gj}]};d.rb=function(){var a=Te(this);a&&(a.signedIn&&(this.Ze=a.signedIn),a.userEmail&&(this.he=a.userEmail),a.kioskAuth&&(this.Gj=a.kioskAuth))};var wm={mz:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},kL:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},xm=wm,xm=wm;var zm=function(a,b){var c=["0"],e=ym[b][0]&7;if(0<e){c.push(".");for(var f=0;f<e;f++)c.push("0")}return a.replace(/0.00/g,c.join(""))},ym={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Am={oz:".",ts:",",sz:"%",ys:"0",ML:"+",EL:"-",rz:"E",uz:"\u2030",us:"\u221e",JL:"NaN",nz:"#,##0.###",gM:"#E0",LL:"#,##0%",lL:"\u00a4#,##0.00",oL:"USD"},Bm=Am,Bm=Am;var Cm=function(a,b,c){this.am=b||Bm.oL;this.pP=c||0;this.tq=40;this.Ed=1;this.li=0;this.Eh=3;this.zq=this.Me=0;this.MJ=this.NK=!1;this.Dm=this.Rh="";this.Zf="-";this.Vj="";this.Zc=1;this.Jh=!1;this.qh=[];this.ds=this.fB=!1;this.fl=0;this.jA=null;"number"==typeof a?this.cN(a):this.Ei(a)};d=Cm.prototype;d.e5=function(a){if(0<this.li&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.Me=a;return this};d.Z4=function(a){this.Eh=a;return this};
d.m6=function(a){if(0<this.Me&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.li=a;return this};d.Ei=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.Rh=this.Iq(a,b);var c=b[0];this.H0(a,b);c=b[0]-c;this.Dm=this.Iq(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.Zc&&(this.Jh=!0),this.Zf=this.Iq(a,b),b[0]+=c,this.Vj=this.Iq(a,b)):(this.Zf=this.Rh+this.Zf,this.Vj+=this.Dm)};
d.cN=function(a){switch(a){case 1:this.Ei(Bm.nz);break;case 2:this.Ei(Bm.gM);break;case 3:this.Ei(Bm.LL);break;case 4:this.Ei(zm(Bm.lL,this.am));break;case 5:this.$z(1);break;case 6:this.$z(2);break;default:throw Error("Unsupported pattern type.");}};d.$z=function(a){this.fl=a;this.Ei(Bm.nz);this.e5(0);this.Z4(2);this.m6(2)};
d.parse=function(a,b){var c=b||[0];if(0!=this.fl)throw Error("Parsing of compact numbers is unimplemented");var e=NaN;a=a.replace(/ /g,"\u00a0");var f=a.indexOf(this.Rh,c[0])==c[0],g=a.indexOf(this.Zf,c[0])==c[0];f&&g&&(this.Rh.length>this.Zf.length?g=!1:this.Rh.length<this.Zf.length&&(f=!1));f?c[0]+=this.Rh.length:g&&(c[0]+=this.Zf.length);a.indexOf(Bm.us,c[0])==c[0]?(c[0]+=Bm.us.length,e=Infinity):e=this.s0(a,c);if(f){if(a.indexOf(this.Dm,c[0])!=c[0])return NaN;c[0]+=this.Dm.length}else if(g){if(a.indexOf(this.Vj,
c[0])!=c[0])return NaN;c[0]+=this.Vj.length}return g?-e:e};
d.s0=function(a,b){var c=!1,e=!1,f=!1,g=1,k=Bm.oz,l=Bm.ts,w=Bm.rz;if(0!=this.fl)throw Error("Parsing of compact style numbers is not implemented");for(var C="";b[0]<a.length;b[0]++){var D=a.charAt(b[0]),S=this.OC(D);if(0<=S&&9>=S)C+=S,f=!0;else if(D==k.charAt(0)){if(c||e)break;C+=".";c=!0}else if(D==l.charAt(0)&&("\u00a0"!=l.charAt(0)||b[0]+1<a.length&&0<=this.OC(a.charAt(b[0]+1)))){if(c||e)break}else if(D==w.charAt(0)){if(e)break;C+="E";e=!0}else if("+"==D||"-"==D)C+=D;else if(1==this.Zc&&D==Bm.sz.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.Zc&&D==Bm.uz.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.Zc&&(g=this.Zc);return parseFloat(C)/g};d.format=function(a){if(isNaN(a))return Bm.JL;var b=[],c=this.PV(null===this.jA?a:this.jA,a);a/=Math.pow(10,c.Jt);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.Zf:this.Rh);isFinite(a)?(a=a*(e?-1:1)*this.Zc,this.ds?this.E7(a,b):this.My(a,this.Ed,b)):b.push(Bm.us);b.push(e?this.Vj:this.Dm);b.push(c.bK);return b.join("")};
d.Ox=function(a){var b=Math.pow(10,this.Eh),c=0>=this.li?Math.round(a*b):Math.round(this.Q2(a*b,this.li,this.Eh));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{Jv:a,YB:b}};
d.My=function(a,b,c){if(this.Me>this.Eh)throw Error("Min value must be less than max value");c||(c=[]);a=this.Ox(a);var e=Math.pow(10,this.Eh),f=a.Jv,g=a.YB,k=0==f?0:this.Xp(f)+1,l=0<this.Me||0<g||this.MJ&&k<this.li;a=this.Me;l&&(a=this.MJ&&0<this.li?this.li-k:this.Me);for(var w="",k=f;1E20<k;)w="0"+w,k=Math.round(k/10);var w=k+w,C=Bm.oz,k=Bm.ys.charCodeAt(0),D=w.length,S=0;if(0<f||0<b){for(f=D;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.qh.length)for(b=1;b<this.qh.length;b++)S+=this.qh[b];
b=D-S;if(0<b)for(var f=this.qh,V=S=D=0,Ka=Bm.ts,tb=w.length,Gb=0;Gb<tb;Gb++){if(c.push(String.fromCharCode(k+1*Number(w.charAt(Gb)))),1<tb-Gb)if(V=f[S],Gb<b){var Ni=b-Gb;(1===V||0<V&&1===Ni%V)&&c.push(Ka)}else S<f.length&&(Gb===b?S+=1:V===Gb-b-D+1&&(c.push(Ka),D+=V,S+=1))}else{b=w;w=this.qh;f=Bm.ts;S=0;V=b.length;Ka=[];for(D=w.length-1;0<=D&&0<V;D--){S=w[D];for(tb=0;tb<S&&0<=V-tb-1;tb++)Ka.push(String.fromCharCode(k+1*Number(b.charAt(V-tb-1))));V-=S;0<V&&Ka.push(f)}c.push.apply(c,Ka.reverse())}}else l||
c.push(String.fromCharCode(k));(this.fB||l)&&c.push(C);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.Jz=function(a,b){b.push(Bm.rz);0>a?(a=-a,b.push(Bm.EL)):this.NK&&b.push(Bm.ML);for(var c=""+a,e=Bm.ys,f=c.length;f<this.zq;f++)b.push(e);b.push(c)};
d.E7=function(a,b){if(0==a)this.My(a,this.Ed,b),this.Jz(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a/=Math.pow(10,c);var e=this.Ed;if(1<this.tq&&this.tq>this.Ed){for(;0!=c%this.tq;)a*=10,c--;e=1}else 1>this.Ed?(c++,a/=10):(c-=this.Ed-1,a*=Math.pow(10,this.Ed-1));this.My(a,e,b);this.Jz(c,b)}};d.OC=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Bm.ys.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.Iq=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.am;else switch(this.pP){case 0:c+=ym[this.am][1];break;case 2:var g=this.am,k=ym[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=ym[this.am][2]}break;case "%":if(!this.Jh&&1!=this.Zc)throw Error("Too many percent/permill");
if(this.Jh&&100!=this.Zc)throw Error("Inconsistent use of percent/permill characters");this.Zc=100;this.Jh=!1;c+=Bm.sz;break;case "\u2030":if(!this.Jh&&1!=this.Zc)throw Error("Too many percent/permill");if(this.Jh&&1E3!=this.Zc)throw Error("Inconsistent use of percent/permill characters");this.Zc=1E3;this.Jh=!1;c+=Bm.uz;break;default:c+=g}}return c};
d.H0=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,l=a.length,w=!0;b[0]<l&&w;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.qh.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.ds)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.ds=!0;this.zq=0;b[0]+1<l&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.NK=!0);for(;b[0]+1<l&&"0"==a.charAt(b[0]+1);)b[0]++,this.zq++;if(1>e+f||1>this.zq)throw Error('Malformed exponential pattern "'+a+'"');w=!1;break;default:b[0]--,w=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');g=e+f+g;this.Eh=0<=c?g-c:0;0<=c&&(this.Me=e+f-c,0>this.Me&&(this.Me=0));this.Ed=(0<=c?c:g)-e;this.ds&&(this.tq=e+this.Ed,0==this.Eh&&0==this.Ed&&(this.Ed=1));this.qh.push(Math.max(0,k));this.fB=
0==c||c==g};var Dm={prefix:"",bK:"",Jt:0};d=Cm.prototype;d.$D=function(a,b){var c=1==this.fl?xm.mz:xm.kL;null==c&&(c=xm.mz);if(3>a)return Dm;a=Math.min(14,a);for(var e=c[Math.pow(10,a)],f=a-1;!e&&3<=f;)e=c[Math.pow(10,f)],f--;if(!e)return Dm;c=e[b];return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],bK:c[3],Jt:f+1-(c[2].length-1)}:Dm:Dm};
d.PV=function(a,b){if(0==this.fl)return Dm;a=Math.abs(a);b=Math.abs(b);var c=this.$D(1>=a?0:this.Xp(a),this.eH(a)).Jt,e=this.Ox(b/Math.pow(10,c));return this.$D(c+this.Xp(this.Ox(a/Math.pow(10,c)).Jv),this.eH(e.Jv+e.YB))};d.Xp=function(a){for(var b=0;1<=(a/=10);)b++;return b};d.Q2=function(a,b,c){if(!a)return a;b=b-this.Xp(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};d.eH=function(){return"other"};var Em=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Fm=Em,Fm=Em;var Gm=function(a,b){var c;if(void 0===b){c=a+"";var e=c.indexOf(".");c=Math.min(-1==e?0:c.length-e-1,3)}else c=b;return 1==(a|0)&&0==c?"one":"other"},Hm=Gm,Hm=Gm;var Im=function(a){this.Lj=[];this.Yw=[];this.Dw=new Cm(1);this.u0(a)},Jm=/'([{}#].*?)'/g,Km=/''/g;d=Im.prototype;d.format=function(a){return this.Uo(a,!1)};d.Uo=function(a,b){if(0==this.Yw.length)return"";var c=[];this.hu(this.Yw,a,b,c);for(c=c.join("");0<this.Lj.length;)c=c.replace(this.bt(this.Lj),this.Lj.pop());return c};
d.hu=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.MQ(g,b,e);break;case 2:g=a[f].value;this.LQ(g,b,c,e);break;case 0:g=a[f].value;this.WB(g,b,Hm,c,e);break;case 1:g=a[f].value;this.WB(g,b,Fm,c,e);break;default:Na("Unrecognized block type: "+a[f].type)}};d.MQ=function(a,b,c){b=b[a];m(b)?(this.Lj.push(b),c.push(this.bt(this.Lj))):c.push("Undefined parameter - "+a)};
d.LQ=function(a,b,c,e){var f=a.Un;m(b[f])?(f=a[b[f]],m(f)||(f=a.other),this.hu(f,b,c,e)):e.push("Undefined parameter - "+f)};d.WB=function(a,b,c,e,f){var g=a.Un,k=a.bA,l=+b[g];isNaN(l)?f.push("Undefined or invalid parameter - "+g):(k=l-k,g=a[b[g]],m(g)||(c=this.Dw.ST?c(k,this.Dw.ST()):c(k),g=a[c],m(g)||(g=a.other)),a=[],this.hu(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.Dw.format(k),f.push(b.replace(/#/g,e))))};d.u0=function(a){a&&(a=this.oX(a),this.Yw=this.Jq(a))};
d.oX=function(a){var b=this.Lj,c=r(this.bt,this);a=a.replace(Km,function(){b.push("'");return c(b)});return a=a.replace(Jm,function(a,f){b.push(f);return c(b)})};d.Oo=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var Lm=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Mm=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Nm=/^\s*(\w+)\s*,\s*select\s*,/;d=Im.prototype;d.T_=function(a){return Lm.test(a)?0:Mm.test(a)?1:Nm.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.Jq=function(a){var b=[];a=this.Oo(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.T_(a[c].value)){case 2:e.type=2;e.value=this.z0(a[c].value);break;case 0:e.type=0;e.value=this.v0(a[c].value);break;case 1:e.type=1;e.value=this.t0(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:Na("Unknown block type for pattern: "+a[c].value)}else Na("Unknown part of the pattern.");b.push(e)}return b};
d.z0=function(a){var b="";a=a.replace(Nm,function(a,c){b=c;return""});var c={};c.Un=b;a=this.Oo(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.Jq(a[e].value);else Na("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.v0=function(a){var b="",c=0;a=a.replace(Lm,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.Un=b;e.bA=c;a=this.Oo(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.Jq(a[f].value);else Na("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.t0=function(a){var b="";a=a.replace(Mm,function(a,c){b=c;return""});var c={};c.Un=b;c.bA=0;a=this.Oo(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.Jq(a[e].value);else Na("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.bt=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Om=chrome.i18n.getMessage("1522140683318860351"),Pm=chrome.i18n.getMessage("4246483347873264186"),Qm=chrome.i18n.getMessage("5991427458288444010"),Rm=chrome.i18n.getMessage("7735695102441495789"),Sm=chrome.i18n.getMessage("4575332923598659024"),Tm=chrome.i18n.getMessage("2297080986956220930"),Um=new Im(Tm),Vm=function(a,b){return Um.format({ORGANIZER:a,PARTICIPANTS:b})};var Wm=function(a){this.pb=a;this.a=A("mr.cloud.mesi.MesiService")},Xm={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};
Wm.prototype.EQ=function(){var a=this.pb.ej($l.Ag,["hangouts","search"]);F(this.a,"Retrieving Hangouts from MESI: "+a);return this.pb.Dg(a,"POST",Xm).then(function(a){var c=[];a.result&&(c=a.result.map(function(a){var b=a.hangout,c,k;b.external_key?(c=b.external_key.value.replace(/@.*/,""),k=b.external_key.service):b.sharing_url&&(k=b.sharing_url.split("/"),c=k[4],k=k[3]);var l=b.meeting_room_name,w;b.meeting_domain?(w=b.meeting_domain,l&&(c=l,k=w)):"BUSINESS"==b.type&&b.company_title&&(w=b.company_title.toLowerCase());
var C=Vm("",0);if((a=a.participant)&&0<a.length){var D=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(D=b.display_name);return a},new yc);C=Vm(D,a.M())}return new Wl(c,k,l,w,C,b.hangout_id)}));return c})};var Ym=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},Zm=function(a){this.pb=a};Zm.$inject=["gapiService"];d=Zm.prototype;d.k3=function(a,b,c){var e=this;return this.nI(jm,a,b,c,35E3).then(function(a){return e.rE(a)})};d.m3=function(a,b,c){var e=this;return this.nI(im,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.$G(a),new Ym(b,a.type,new em(a.sessionDescription))):new Ym(b)})};d.q3=function(a){return this.de(a,hm,{})};
d.nI=function(a,b,c,e,f){c={_settings:c.settings.Qy(),_optMediaConstraints:JSON.stringify(c.mediaConstraints),_webrtcMessage:JSON.stringify(new em(c.description))};e&&(c._user=JSON.stringify(e));return this.de(b,a,c,f)};d.rE=function(a){var b=a.state;switch(b){case "done":return H(this.e0(a));case "queued":case "inProgress":var c=this;return c.M8(a).then(function(a){return c.rE(a)});default:return H(new Ym(b))}};
d.M8=function(a){var b=this,c=J(),e=setInterval(function(){b.uQ(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c.resolve(a))})},2E3);return c.promise};d.e0=function(a){a=this.$G(a);return"__cloud_webrtc_session_message__"==a.type?new Ym("done","knocking_cloud_webrtc_session_message",new em(a.sessionDescription)):new Ym("done",a.type)};
d.de=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.pb.ej(Yl.Ag,["commands"],b);return this.pb.Dg(e,"POST",a)};d.$G=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};d.uQ=function(a){a=this.pb.ej(Yl.Ag,["commands",a]);return this.pb.Dg(a,"GET")};var $m=function(a,b,c,e){this.De=a;this.Eb=b;this.un=c;this.bd=e};d=$m.prototype;d.zW=function(a,b,c){var e=this;return this.g3(a,b,c).then(function(a){return e.oW(a,b.id)})};d.tW=function(a){var b=this;return this.un.JR().then(function(c){b.bd.ei(new Yg("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.g3=function(a,b,c){b=c.deviceId;var e=this.Eb.gE(),e=e?new cm(e):void 0;a=a.data;switch(c.zs){case "owner":Vl(0);break;case "manager":Vl(1);break;case "user":Vl(2);break;case "viewer":Vl(3)}return"viewer"==c.zs?this.De.k3(b,a,e):this.De.m3(b,a,e)};
d.oW=function(a,b){if("done"!=a.state)return I(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":var c=new Yg("ANSWER",a.results.sessionDescription);this.bd.ei(c,b);break;case "knocking_cloud_webrtc_session_message":Sl(0);c=new Yg("KNOCK_ANSWER",a.results.sessionDescription);this.bd.ei(c,b);break;case "knock_denied":Sl(1);this.qE(Pm,b);break;case "knock_timeout":Sl(2);this.qE(Qm,b);break;default:return I(Error("Invalid message type: "+
a.type))}return H()};d.qE=function(a,b){var c=new Gg(a,"warning","dismiss");c.N4(!0);this.bd.Gf().send(c);this.bd.ei(new Yg("STOP"),b)};var an=function(a,b){this.Eb=a;this.bd=b};an.prototype.wW=function(a,b,c){switch(a.type){case "REFRESH_AUTH":var e=c.deviceId,f=c.QH,g=this;return this.Eb.M1().then(function(){g.bd.ei(new Yg("AUTH_READY",{hangoutId:e,resolvedId:f}),b.id)});case "HANGOUT_INACTIVE":return this.bd.Hk(b,4,new Gg(Rm,"warning","dismiss"));case "HANGOUT_INVALID":return this.bd.Hk(b,3,new Gg(Sm,"warning","dismiss"));default:return I(Error("Unknown type: "+a.type))}};var bn=function(a,b,c){this.Pi=a;this.Yl=b;this.bd=c};
bn.prototype.b1=function(a,b,c,e){switch(a){case "cloud":break;case "mesi":break;default:return I(Error("Unrecognized channel type"))}if(!b.type)return I(Error("Message has no type"));switch(b.type){case "STOP":return this.bd.Hk(c,1,null);case "SESSION_START_SUCCESS":return Tl(0),H();case "SESSION_END":return H();case "SESSION_FAILURE":return Tl(1),this.bd.Hk(c,2,new Gg(Om,"fatal","dismiss"));case "__webrtc_stats__":return H();case "OFFER":return this.Pi.zW(b,c,e);case "GET_TURN_CREDENTIALS":return this.Pi.tW(c);
case "REFRESH_AUTH":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":return this.Yl.wW(b,c,e);default:return I(Error("Unknown type: "+b.type))}};var cn=function(){this.a=A("mr.cloud.settings.SettingsService")};d=cn.prototype;d.e8=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&E(a,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};d.DR=function(){var a=this;return this.BC().na(function(){return a.BC().na(function(b){E(a.a,"Error retrieving cloud on setting: "+JSON.stringify(b));return!1})})};d.BC=function(){return this.eT("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};
d.eT=function(a){var b=J();chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};d.zC=function(){var a=this;return this.AC().na(function(){return a.AC().na(function(b){E(a.a,"Error retrieving cloud enabled setting: "+JSON.stringify(b));return!1})})};d.AC=function(){return this.xU("media_router.cloudservices.enabled").then(function(a){return!!a.value})};
d.xU=function(a){var b=J();chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};var dn=function(a){this.a=A("mr.cloud.CredentialService");this.pb=a};dn.prototype.JR=function(){var a=this,b=J(),c=Jf(am.Ag+"/iceconfig?key="+am.f8,function(){return a.M_(c,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};dn.prototype.M_=function(a,b){a.Cd()?b.resolve(this.DZ(a.XU())):b.resolve(this.EZ(null))};
dn.prototype.DZ=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:a.credential,username:a.username})})});return b}catch(c){return B(this.a,"Error parsing TURN credentials.",c),[]}};dn.prototype.EZ=function(a){B(this.a,"XHR failed fetching TURN credentials.",a instanceof Error?a:void 0);return[]};var en=function(){this.un=this.Ye=this.Rj=this.Yl=this.Pi=this.De=this.yv=this.ft=this.xw=this.ut=this.st=this.pb=this.Ss=null};da(en);d=en.prototype;d.El=function(){null==this.Ss&&(this.Ss=new um);return this.Ss};d.Dl=function(){null==this.pb&&(this.pb=new tm(this.El()));return this.pb};d.BR=function(){null==this.st&&(this.st=new lm(this.Dl()));return this.st};d.ER=function(a){null==this.ut&&(this.ut=new rm(this.BR(),a));return this.ut};
d.NT=function(){null==this.xw&&(this.xw=new Wm(this.Dl()));return this.xw};d.mR=function(){null==this.ft&&(this.ft=new bm(this.Dl(),this.El()));return this.ft};d.SS=function(a){null==this.yv&&(this.yv=new sm(this.mR(),this.NT(),a));return this.yv};d.VC=function(){null==this.De&&(this.De=new Zm(this.Dl()));return this.De};d.CR=function(a){null==this.Pi&&(this.Pi=new $m(this.VC(),this.El(),this.LV(),a));return this.Pi};d.LS=function(a){null==this.Yl&&(this.Yl=new an(this.El(),a));return this.Yl};
d.OT=function(a){null==this.Rj&&(this.Rj=new bn(this.CR(a),this.LS(a),a));return this.Rj};d.oV=function(){null==this.Ye&&(this.Ye=new cn);return this.Ye};d.LV=function(){null==this.un&&(this.un=new dn(this.Dl()));return this.un};var fn=function(a){this.B=a;this.eb=new z;this.mi=[];this.Ye=this.Rj=this.Eb=this.De=this.th=null;this.Aj=this.Kg=this.Oi=!1;Ve(this)};d=fn.prototype;d.a=A("mr.CloudProvider");d.getName=function(){return"cloud"};
d.Wc=function(){F(this.a,"Initializing Cloud MRP");var a=en.O(),b=a.ER(this);this.mi.push(b);this.th=a.SS(this);this.mi.push(this.th);this.De=a.VC();this.Eb=a.El();this.Rj=a.OT(this);this.Ye=a.oV();var c=this;this.Ye.zC().then(function(a){c.Oi=a;F(c.a,"Cloud enabled setting: "+c.Oi)});this.Ye.DR().then(function(a){c.Kg=a;F(c.a,"Cloud on setting: "+c.Kg)})};d.Fe=function(){return this.eb.v()};
d.wl=function(a){if(!this.Mv()||!Sg(a))return Hj;G(this.a,"GetAvailableSinks for "+a);var b=[];if(this.Kg||this.W6())F(this.a,"Checking cloud discovery services"),wf.O().iq=t(),this.mi.forEach(function(a){a=a.oc();b=b.concat(a)});G(this.a,"Available sinks are..."+JSON.stringify(b));var c=b.map(function(a){return a.Xc});return new Gj(c,-1!=a.indexOf("0F5096E8")?Tg:null)};
d.ri=function(a){if((this.Eb.Pv()||this.Eb.TE())&&!this.Aj){var b=gn(a);F(this.a,"startObservingMediaSinks");G(this.a,"urn: "+a);b&&(this.th.Nz(b,"google.com"),this.Aj=!0,this.B.qc(),this.B.onSinkAvailabilityUpdated(this,2),F(this.a,"sinkAvailability changed to AVAILABLE"))}};d.ti=function(a){this.Mv()&&(F(this.a,"stopObservingMediaSinks"),G(this.a,"urn: "+a),(this.Eb.Pv()||this.Eb.TE())&&this.Aj&&(a=gn(a)))&&(this.th.HH(a,"google.com"),this.Aj=!1)};d.pi=function(){};d.si=function(){};
d.ga=function(a){return(a=this.ij(a))?a.Xc:null};d.uf=function(a,b,c,e,f,g,k){F(this.a,"createRoute called");G(this.a,"urn: "+a+" sinkId:"+b);f=this.ij(b);return this.Ho(a,f,b,c,e,g,k).na(function(a){throw a;},this)};
d.Ho=function(a,b,c,e,f,g,k){var l=this;if(f)return I(Error("not supported"));switch(this.Yu(b)){case "cloud":Ul(1);break;case "mesi":Ul(0)}wf.O().Wh=new vf(b.ae,null);var w=Lj(e,this.getName(),c,a,!0,"",null);this.eb.set(w.id,w);this.B.Lh(this,w);F(this.a,"starting mirroring on route: "+w.id);w.$d={tabId:k,sessionId:"",NJ:"",OJ:b.ae};return this.B.kn(this,w).na(function(a){B(l.a,"Error on start mirroring",a);l.Hk(w,5,null);throw a;})};
d.vc=function(a){F(this.a,"terminating route: "+a);return(a=this.eb.get(a))?this.Hk(a,0,null):H()};d.Hk=function(a,b,c){this.eb.remove(a.id);c&&this.Gf().send(c);Mg("MediaRouter.Cloud.Session.End",b,Pl);this.FO(a);this.B.ag(this,a);return H()};d.lg=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.eb.get(a)||void 0)?this.ij(a.sinkId):void 0;return this.Rj.b1(c,b,a,e)}return this.wX(b)?this.lW(b,a):I(Error("Channel type missing"))};d.Hf=function(){return Dh(!0,!0)};
d.Gl=function(a){var b=null;a=this.ij(a);switch(this.Yu(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}F(this.a,"mirror service: "+b);return b};d.$k=function(a,b){G(this.a,"Checking canRoute: "+a+" for sinkId: "+b);return this.Mv()&&Sg(a)&&!!this.ga(b)};d.Ki=function(){return!1};d.xh=function(){return I(Error("not supported"))};d.Lg=function(){return I(Error("not supported"))};d.yf=function(){};
d.C_=function(a){F(this.a,a.length+" sinks added");0<a.length&&!this.Kg&&(this.Ye.e8(),this.Kg=!0);a=this.ij(a[0].id);wf.O().Vh=new vf(a.ae,null);this.B.qc();this.B.onSinkAvailabilityUpdated(this,2);F(this.a,"sinkAvailability changed to AVAILABLE")};d.cg=function(a){F(this.a,a.length+" sinks removed");this.mi.some(function(a){return 0<a.oc().length})||(this.B.onSinkAvailabilityUpdated(this,0),F(this.a,"sinkAvailability changed to UNAVAILABLE"));this.B.qc()};
d.qc=function(a){F(this.a,a.length+" sinks updated");this.B.qc()};d.Gf=function(){return this.B.Gf()};d.ei=function(a,b,c){c?this.B.Gd(this,b,a):this.B.Cq(this,b,a)};d.ij=function(a){var b=null;this.mi.some(function(c){if(c=c.ga(a))return b=c,!!c});return b};d.FO=function(a){a=this.ij(a.sinkId);switch(this.Yu(a)){case "cloud":this.De.q3(a.deviceId)}};d.Yu=function(a){return a.cK("cloud")?"cloud":a.cK("mesi")?"mesi":null};d.W6=function(){var a=wf.O().iq;return 3E5<=t()-a};
d.Mv=function(){var a=this;if(this.Eb.Pv()&&!this.Eb.bF())return this.B.onSinkAvailabilityUpdated(this,2),!0;var b=!1,c=this;this.Ye.zC().then(function(a){c.Oi=a});this.Oi&&this.Eb.bF()&&(b=!0);chrome.declarativeWebRequest||this.Eb.TX()||!this.th||(this.mi=this.mi.filter(function(b){return b!=a.th}),this.th=null);return b};var gn=function(a){return(a=(new Xi(a)).kj().match("__castMeetingName__=([^/]*)"))?a[1]:null};d=fn.prototype;d.Oa=function(){return"CloudProvider"};
d.getData=function(){return[{hasPresentationUrlSink:this.Aj},{cloudEnabled:this.Oi,cloudOn:this.Kg}]};d.rb=function(){var a=Se(this);a&&(this.Aj=a.hasPresentationUrlSink);if(a=Te(this))a.cloudEnabled&&(this.Oi=a.cloudEnabled),a.cloudOn&&(this.Kg=a.cloudOn)};d.wX=function(a){return p(a)&&-1!=a.indexOf("clientId")};
d.lW=function(a,b){var c=JSON.parse(a),e=c.clientId;return e?("client_connect"==c.type?this.ei({message:{sessionId:"castouts"},clientId:e,type:"new_session"},b,!0):"v2_message"==c.type&&"STOP"==c.message.type&&(this.ei({message:"castouts",clientId:e,type:"remove_session"},b,!0),this.vc(b)),H()):I(Error("Invalid cast message"))};var hn=function(){this.nH=r(this.JM,this);this.Ce=new Oh;this.Ce.Cy=!1;this.Ce.Er=!1;this.QE=this.Ce.Zz=!1;this.EF="";this.BQ={}};hn.prototype.yu=function(){return this.Ce};hn.prototype.Q3=function(a){if(a!=this.QE){var b=ud();a?b.Kz(this.nH):b.c2(this.nH);this.QE=a}};hn.prototype.JM=function(a){if(!this.BQ[a.jD()]){var b=this.Ce.XB(a),c=jn;if(c)switch(a.Ju()){case id:kn(c,"info",b);break;case jd:kn(c,"error",b);break;case kd:kn(c,"warn",b);break;default:kn(c,"debug",b)}else this.EF+=b}};
var jn=h.console,kn=function(a,b,c){if(a[b])a[b](c);else a.log(c)};var ln=function(){this.pe=new Ih(1E3);this.Ce=new Oh};da(ln);d=ln.prototype;d.init=function(){var a=this.SR();vd("mr").uk(a);vd("goog").uk(ld);Zc(wd(vd("browser")));ud().Kz(r(this.VZ,this));this.Ce.Dy=!0;this.Ce.Er=!0;if(a=window.localStorage["debug.logs"]){var b={all:qd,fine:od,info:ld,warning:kd,severe:jd,off:hd};vd("mr").uk(b[a.toLowerCase()]||od)}window.localStorage["debug.console"]&&(a=new hn,a.yu().Dy=!0,a.yu().Er=!0,a.yu().Cy=!0,a.Q3(!0))};
d.VZ=function(a){this.pe.add(this.Ce.XB(a));(a=a.RC())&&a.stack&&this.pe.add(a.stack)};d.getLogs=function(){return 0==this.pe.M()?"NA":this.pe.v().join("")};d.SR=function(){return ld};d.O1=function(){Ve(this)};d.Oa=function(){return"LogManager"};d.getData=function(){return[this.pe.v()]};d.rb=function(){var a=this.pe.v();this.pe.clear();(Se(this)||[]).forEach(function(a){this.pe.add(a)},this);a.forEach(function(a){this.pe.add(a)},this)};var mn,nn,on=A("mr.Init"),pn=function(a){var b;b=new Wj(a);b=[new Qk(a,b),b];b.push(new fn(a));return b};ln.O().init();mn=new Ig("MediaRouter.Provider.WakeDuration");nn=new Jl;
var qn=function(){var a=J();switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a.resolve();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(b){chrome.runtime.lastError||!b.enabled?a.resolve():a.reject("Dev extension is enabled")});break;default:a.reject("Unknown extension id")}return a.promise}().then(function(){if(!chrome.mojoPrivate||!chrome.mojoPrivate.requireAsync)return I(Error("No mojo service loaded"));var a=J();
chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a.resolve({mrService:b,mrInstanceId:c})})});return a.promise}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");F(on,"MR instance ID: "+b);a=a.mrService;if(!nn)throw Error("providerManager not initialized.");a.setHandlers(nn);Xe(b)&&mn.vk("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(mn.end.bind(mn));
af(b);ln.O().O1();b=pn(nn);$d=function(a){var b=a;b.stack||(b=Error(a));B(on,"Unhandled promise rejection.",b)};nn.Wc(a,b)}).na(function(a){E(on,a.message);throw a;});
chrome.runtime.onMessage.addListener(function(a,b,c){if(b.id==chrome.runtime.id&&"chrome-extension://"+b.id+"/feedback.html"==b.url&&"retrieve_log_data"==a.type){var e={logs:ln.O().getLogs(),device:wf.O().IU()},f="Chromecast"==e.device.model?Rf(e.device.ip):H();nn.TT("cast_streaming").then(function(b){return b.UT(a.source)}).then(function(a){e.castStreamingLogs=a}).Va(function(){f.then(function(a){a&&(e.device.version=a)}).Va(function(){c(e)})});return!0}});qn.na(function(){window.close()});
